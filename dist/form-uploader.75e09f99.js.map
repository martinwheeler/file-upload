{"version":3,"sources":["../vendor/simple-ajax-uploader.js","../node_modules/validatorjs/src/rules.js","../node_modules/validatorjs/src/attributes.js","../node_modules/validatorjs/src/messages.js","../node_modules/validatorjs/src/lang/en.js","../node_modules/validatorjs/src/lang.js","../node_modules/validatorjs/src/errors.js","../node_modules/validatorjs/src/async.js","../node_modules/validatorjs/src/validator.js","form-uploader.tsx"],"names":["global","factory","define","amd","module","exports","ss","window","XhrOk","rLWhitespace","rTWhitespace","uidReplace","rPath","rExt","rHasClass","isSafari","Object","prototype","toString","call","HTMLElement","indexOf","isIE7to9","navigator","userAgent","isIE7","input","document","createElement","type","File","XMLHttpRequest","upload","obj2string","obj","prefix","str","prop","hasOwnProperty","k","v","push","encodeURIComponent","join","extendObj","first","second","addEvent","elem","fn","addEventListener","attachEvent","removeEvent","removeEventListener","name","detachEvent","newXHR","ActiveXObject","err","encodeUTF8","unescape","getIFrame","id","iframe","getUID","src","style","display","getForm","opts","form","encoding","enctype","getHidden","value","parseJSON","data","trim","JSON","parse","rvalidtokens","requireNonComma","depth","replace","token","comma","open","close","Function","getBox","box","docElem","top","left","getBoundingClientRect","documentElement","pageYOffset","scrollTop","clientTop","pageXOffset","scrollLeft","clientLeft","offsetLeft","offsetTop","offsetParent","Math","round","addStyles","styles","copyLayout","from","to","position","width","offsetWidth","height","offsetHeight","c","r","random","text","array","i","len","length","arrayDelete","index","splice","getFilename","path","getExt","file","isVisible","nodeType","body","parentNode","getStyle","toLowerCase","getComputedStyle","ownerDocument","defaultView","getPropertyValue","currentStyle","getFormObj","elems","elements","ignore","inputs","disabled","checked","val","nodeName","toUpperCase","options","selectedIndex","one","values","selected","hasClass","className","addClass","removeClass","e","RegExp","purge","d","a","l","n","attributes","childNodes","remove","removeChild","verifyElem","jQuery","charAt","substr","getElementById","cursor","preventDefault","event","returnValue","_options","uploadSetup","SimpleUpload","_opts","button","url","dropzone","dragClass","overrideSubmit","cors","withCredentials","progressUrl","sessionProgressUrl","nginxProgressUrl","multiple","multipleSelect","maxUploads","queue","checkProgressInterval","keyParamName","sessionProgressName","nginxProgressHeader","customProgressHeaders","corsInputName","allowedExtensions","accept","maxSize","noParams","autoSubmit","multipart","method","responseType","debug","hoverClass","focusClass","disabledClass","customHeaders","encodeHeaders","autoCalibrate","onBlankSubmit","onAbort","filename","uploadBtn","size","onChange","extension","onSubmit","onProgress","pct","onUpdateFileSize","filesize","onComplete","response","onDone","status","textStatus","onAllDone","onExtError","onSizeError","fileSize","onError","statusText","startXHR","endXHR","startNonXHR","endNonXHR","_queue","_active","_disabled","_maxFails","_progKeys","_sizeFlags","_btns","addButton","addDZ","Error","setForm","_createInput","_manDisabled","enable","destroy","off","_killInput","_destroy","log","console","setData","setOptions","btn","Array","rerouteClicks","addDropZone","setProgressBar","_progBar","setPctBox","_pctBox","setFileSizeBox","_sizeBox","setProgressContainer","_progBox","setAbortBtn","_abortBtn","_removeAbort","_form","self","_validateForm","submit","getQueueSize","removeCurrent","_cycleQueue","clearQueue","disable","_self","_input","visibility","updatePosition","detachOver","detachClick","_overBtn","click","setTimeout","interval","_","auto","_checkFile","ext","_initUpload","IframeUpload","_detachEvents","_detach","_getHost","uri","href","hostname","_addFiles","undefined","_uploadIframe","fileObj","progBox","sizeBox","progBar","pctBox","abortBtn","removeAbort","cancel","key","msgLoaded","iframeLoaded","action","target","innerHTML","msgId","origin","_finish","appendChild","location","_errorFinish","doc","contentDocument","contentWindow","message","execCommand","concat","_last","_hasProgUrl","_getProg","counter","xhr","callback","time","Date","getTime","readyState","onreadystatechange","responseText","state","parseInt","received","success","XDomainRequest","onprogress","ontimeout","onload","onerror","params","headers","setRequestHeader","send","XhrUpload","files","total","_uploadXhr","isAbort","abort","lengthComputable","loaded","formData","FormData","hasFile","append","DragAndDrop","_dragFileCheck","dataTransfer","types","collection","zIndex","ondragenter","stopPropagation","ondragover","dropEffect","ondragend","ondragleave","ondrop","div","overflow","margin","padding","opacity","direction","pointerEvents","filter","right","fontSize","fontFamily","turnOff","mouseOverOff","mouseOutOff","focusOff","blurOff","errorType","extOk","checkValidity"],"mappings":"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","file":"form-uploader.75e09f99.js","sourceRoot":"../src","sourcesContent":["/**\n * Simple Ajax Uploader\n * Version 2.6.2\n * https://github.com/LPology/Simple-Ajax-Uploader\n *\n * Copyright 2012-2017 LPology, LLC\n * Released under the MIT license\n */\n\n(function(global, factory) {\n  /*globals define, module */\n  if (typeof define === \"function\" && define.amd) {\n    define(function() {\n      return factory(global);\n    });\n  } else if (typeof module === \"object\" && module.exports) {\n    module.exports = factory(global);\n  } else {\n    global.ss = factory(global);\n  }\n})(typeof window !== \"undefined\" ? window : this, function(window) {\n  var ss = window.ss || {},\n    // ss.trim()\n    rLWhitespace = /^\\s+/,\n    rTWhitespace = /\\s+$/,\n    // ss.getUID\n    uidReplace = /[xy]/g,\n    // ss.getFilename()\n    rPath = /.*(\\/|\\\\)/,\n    // ss.getExt()\n    rExt = /.*[.]/,\n    // ss.hasClass()\n    rHasClass = /[\\t\\r\\n]/g,\n    // Check for Safari -- it doesn't like multi file uploading. At all.\n    // http://stackoverflow.com/a/9851769/1091949\n    isSafari =\n      Object.prototype.toString\n        .call(window.HTMLElement)\n        .indexOf(\"Constructor\") > 0,\n    // Detect IE7-9\n    isIE7to9 =\n      navigator.userAgent.indexOf(\"MSIE\") !== -1 &&\n      navigator.userAgent.indexOf(\"MSIE 1\") === -1,\n    isIE7 = navigator.userAgent.indexOf(\"MSIE 7\") !== -1,\n    // Check whether XHR uploads are supported\n    input = document.createElement(\"input\"),\n    XhrOk;\n\n  input.type = \"file\";\n\n  XhrOk =\n    \"multiple\" in input &&\n    typeof File !== \"undefined\" &&\n    typeof new XMLHttpRequest().upload !== \"undefined\";\n\n  /**\n   * Converts object to query string\n   */\n  ss.obj2string = function(obj, prefix) {\n    \"use strict\";\n\n    var str = [];\n\n    for (var prop in obj) {\n      if (obj.hasOwnProperty(prop)) {\n        var k = prefix ? prefix + \"[\" + prop + \"]\" : prop,\n          v = obj[prop];\n        str.push(\n          typeof v === \"object\"\n            ? ss.obj2string(v, k)\n            : encodeURIComponent(k) + \"=\" + encodeURIComponent(v)\n        );\n      }\n    }\n\n    return str.join(\"&\");\n  };\n\n  /**\n   * Copies all missing properties from second object to first object\n   */\n  ss.extendObj = function(first, second) {\n    \"use strict\";\n\n    for (var prop in second) {\n      if (second.hasOwnProperty(prop)) {\n        first[prop] = second[prop];\n      }\n    }\n  };\n\n  ss.addEvent = function(elem, type, fn) {\n    \"use strict\";\n\n    if (elem.addEventListener) {\n      elem.addEventListener(type, fn, false);\n    } else {\n      elem.attachEvent(\"on\" + type, fn);\n    }\n    return function() {\n      ss.removeEvent(elem, type, fn);\n    };\n  };\n\n  ss.removeEvent = document.removeEventListener\n    ? function(elem, type, fn) {\n        if (elem.removeEventListener) {\n          elem.removeEventListener(type, fn, false);\n        }\n      }\n    : function(elem, type, fn) {\n        var name = \"on\" + type;\n\n        if (typeof elem[name] === \"undefined\") {\n          elem[name] = null;\n        }\n\n        elem.detachEvent(name, fn);\n      };\n\n  ss.newXHR = function() {\n    \"use strict\";\n\n    if (typeof XMLHttpRequest !== \"undefined\") {\n      return new window.XMLHttpRequest();\n    } else if (window.ActiveXObject) {\n      try {\n        return new window.ActiveXObject(\"Microsoft.XMLHTTP\");\n      } catch (err) {\n        return false;\n      }\n    }\n  };\n\n  ss.encodeUTF8 = function(str) {\n    \"use strict\";\n    /*jshint nonstandard:true*/\n    return unescape(encodeURIComponent(str));\n  };\n\n  ss.getIFrame = function() {\n    \"use strict\";\n\n    var id = ss.getUID(),\n      iframe;\n\n    // IE7 can only create an iframe this way, all others are the other way\n    if (isIE7) {\n      iframe = document.createElement(\n        '<iframe src=\"javascript:false;\" name=\"' + id + '\">'\n      );\n    } else {\n      iframe = document.createElement(\"iframe\");\n      /*jshint scripturl:true*/\n      iframe.src = \"javascript:false;\";\n      iframe.name = id;\n    }\n\n    iframe.style.display = \"none\";\n    iframe.id = id;\n    return iframe;\n  };\n\n  ss.getForm = function(opts) {\n    \"use strict\";\n\n    var form = document.createElement(\"form\");\n\n    form.encoding = \"multipart/form-data\"; // IE\n    form.enctype = \"multipart/form-data\";\n    form.style.display = \"none\";\n\n    for (var prop in opts) {\n      if (opts.hasOwnProperty(prop)) {\n        form[prop] = opts[prop];\n      }\n    }\n\n    return form;\n  };\n\n  ss.getHidden = function(name, value) {\n    \"use strict\";\n\n    var input = document.createElement(\"input\");\n\n    input.type = \"hidden\";\n    input.name = name;\n    input.value = value;\n    return input;\n  };\n\n  /**\n   * Parses a JSON string and returns a Javascript object\n   * Borrowed from www.jquery.com\n   */\n  ss.parseJSON = function(data) {\n    \"use strict\";\n    /*jshint evil:true*/\n\n    if (!data) {\n      return false;\n    }\n\n    data = ss.trim(data + \"\");\n\n    if (window.JSON && window.JSON.parse) {\n      try {\n        // Support: Android 2.3\n        // Workaround failure to string-cast null input\n        return window.JSON.parse(data + \"\");\n      } catch (err) {\n        return false;\n      }\n    }\n\n    var rvalidtokens = /(,)|(\\[|{)|(}|])|\"(?:[^\"\\\\\\r\\n]|\\\\[\"\\\\\\/bfnrt]|\\\\u[\\da-fA-F]{4})*\"\\s*:?|true|false|null|-?(?!0\\d)\\d+(?:\\.\\d+|)(?:[eE][+-]?\\d+|)/g,\n      depth = null,\n      requireNonComma;\n\n    // Guard against invalid (and possibly dangerous) input by ensuring that nothing remains\n    // after removing valid tokens\n    return data &&\n      !ss.trim(\n        data.replace(rvalidtokens, function(token, comma, open, close) {\n          // Force termination if we see a misplaced comma\n          if (requireNonComma && comma) {\n            depth = 0;\n          }\n\n          // Perform no more replacements after returning to outermost depth\n          if (depth === 0) {\n            return token;\n          }\n\n          // Commas must not follow \"[\", \"{\", or \",\"\n          requireNonComma = open || comma;\n\n          // Determine new depth\n          // array/object open (\"[\" or \"{\"): depth += true - false (increment)\n          // array/object close (\"]\" or \"}\"): depth += false - true (decrement)\n          // other cases (\",\" or primitive): depth += true - true (numeric cast)\n          depth += !close - !open;\n\n          // Remove this token\n          return \"\";\n        })\n      )\n      ? Function(\"return \" + data)()\n      : false;\n  };\n\n  ss.getBox = function(elem) {\n    \"use strict\";\n\n    var box,\n      docElem,\n      top = 0,\n      left = 0;\n\n    if (elem.getBoundingClientRect) {\n      box = elem.getBoundingClientRect();\n      docElem = document.documentElement;\n      top =\n        box.top +\n        (window.pageYOffset || docElem.scrollTop) -\n        (docElem.clientTop || 0);\n      left =\n        box.left +\n        (window.pageXOffset || docElem.scrollLeft) -\n        (docElem.clientLeft || 0);\n    } else {\n      do {\n        left += elem.offsetLeft;\n        top += elem.offsetTop;\n      } while ((elem = elem.offsetParent));\n    }\n\n    return {\n      top: Math.round(top),\n      left: Math.round(left)\n    };\n  };\n\n  /**\n   * Helper that takes object literal\n   * and add all properties to element.style\n   * @param {Element} el\n   * @param {Object} styles\n   */\n  ss.addStyles = function(elem, styles) {\n    \"use strict\";\n\n    for (var name in styles) {\n      if (styles.hasOwnProperty(name)) {\n        elem.style[name] = styles[name];\n      }\n    }\n  };\n\n  /**\n   * Function places an absolutely positioned\n   * element on top of the specified element\n   * copying position and dimensions.\n   */\n  ss.copyLayout = function(from, to) {\n    \"use strict\";\n\n    var box = ss.getBox(from);\n\n    ss.addStyles(to, {\n      position: \"absolute\",\n      left: box.left + \"px\",\n      top: box.top + \"px\",\n      width: from.offsetWidth + \"px\",\n      height: from.offsetHeight + \"px\"\n    });\n  };\n\n  /**\n   * Generates unique ID\n   * Complies with RFC 4122 version 4\n   * http://stackoverflow.com/a/2117523/1091949\n   * ID begins with letter \"a\" to be safe for HTML elem ID/name attr (can't start w/ number)\n   */\n  ss.getUID = function() {\n    \"use strict\";\n\n    /*jshint bitwise: false*/\n    return \"axxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(uidReplace, function(\n      c\n    ) {\n      var r = (Math.random() * 16) | 0,\n        v = c == \"x\" ? r : (r & 0x3) | 0x8;\n      return v.toString(16);\n    });\n  };\n\n  /**\n   * Removes white space from left and right of string\n   * Uses native String.trim if available\n   * Adapted from www.jquery.com\n   */\n  var trim = \"\".trim;\n\n  ss.trim =\n    trim && !trim.call(\"\\uFEFF\\xA0\")\n      ? function(text) {\n          return text === null ? \"\" : trim.call(text);\n        }\n      : function(text) {\n          return text === null\n            ? \"\"\n            : text\n                .toString()\n                .replace(rLWhitespace, \"\")\n                .replace(rTWhitespace, \"\");\n        };\n\n  var arr = [];\n\n  ss.indexOf = arr.indexOf\n    ? function(array, elem) {\n        return array.indexOf(elem);\n      }\n    : function(array, elem) {\n        for (var i = 0, len = array.length; i < len; i++) {\n          if (array[i] === elem) {\n            return i;\n          }\n        }\n        return -1;\n      };\n\n  /**\n   * Removes an element from an array\n   */\n  ss.arrayDelete = function(array, elem) {\n    var index = ss.indexOf(array, elem);\n\n    if (index > -1) {\n      array.splice(index, 1);\n    }\n  };\n\n  /**\n   * Extract file name from path\n   */\n  ss.getFilename = function(path) {\n    \"use strict\";\n    return path.replace(rPath, \"\");\n  };\n\n  /**\n   * Get file extension\n   */\n  ss.getExt = function(file) {\n    \"use strict\";\n    return -1 !== file.indexOf(\".\") ? file.replace(rExt, \"\") : \"\";\n  };\n\n  /**\n   * Checks whether an element is visible\n   */\n  ss.isVisible = function(elem) {\n    \"use strict\";\n\n    if (!elem) {\n      return false;\n    }\n\n    if (elem.nodeType !== 1 || elem == document.body) {\n      elem = null;\n      return true;\n    }\n\n    if (\n      elem.parentNode &&\n      (elem.offsetWidth > 0 ||\n        elem.offsetHeight > 0 ||\n        ss.getStyle(elem, \"display\").toLowerCase() != \"none\")\n    ) {\n      return ss.isVisible(elem.parentNode);\n    }\n\n    elem = null;\n    return false;\n  };\n\n  ss.getStyle = function(elem, style) {\n    \"use strict\";\n\n    if (window.getComputedStyle) {\n      var cs = elem.ownerDocument.defaultView.getComputedStyle(elem, null);\n      return cs.getPropertyValue(style);\n    } else if (elem.currentStyle && elem.currentStyle[style]) {\n      return elem.currentStyle[style];\n    }\n  };\n\n  /**\n   * Accepts a form element and returns an object with key/value pairs for the form fields\n   */\n  ss.getFormObj = function(form) {\n    \"use strict\";\n\n    var elems = form.elements,\n      ignore = [\"button\", \"submit\", \"image\", \"reset\"],\n      inputs = {},\n      obj;\n\n    for (var i = 0, len = elems.length; i < len; i++) {\n      obj = {};\n\n      if (\n        elems[i].name &&\n        !elems[i].disabled &&\n        ss.indexOf(ignore, elems[i].type) === -1\n      ) {\n        if (\n          (elems[i].type == \"checkbox\" || elems[i].type == \"radio\") &&\n          !elems[i].checked\n        ) {\n          continue;\n        }\n\n        obj[elems[i].name] = ss.val(elems[i]);\n        ss.extendObj(inputs, obj);\n      }\n    }\n\n    return inputs;\n  };\n\n  /**\n   * Accepts a form input element and returns its value\n   */\n  ss.val = function(elem) {\n    \"use strict\";\n\n    if (!elem) {\n      return;\n    }\n\n    if (elem.nodeName.toUpperCase() == \"SELECT\") {\n      var options = elem.options,\n        index = elem.selectedIndex,\n        one = elem.type === \"select-one\" || index < 0,\n        values = one ? null : [],\n        value;\n\n      for (var i = 0, len = options.length; i < len; i++) {\n        if ((options[i].selected || i === index) && !options[i].disabled) {\n          value = !options[i].value ? options[i].text : options[i].value;\n\n          if (one) {\n            return value;\n          }\n\n          values.push(value);\n        }\n      }\n\n      return values;\n    } else {\n      return elem.value;\n    }\n  };\n\n  /**\n   * Check whether element has a particular CSS class\n   * Parts borrowed from www.jquery.com\n   */\n  ss.hasClass = function(elem, name) {\n    \"use strict\";\n\n    if (!elem || !name) {\n      return false;\n    }\n\n    return (\n      (\" \" + elem.className + \" \")\n        .replace(rHasClass, \" \")\n        .indexOf(\" \" + name + \" \") >= 0\n    );\n  };\n\n  /**\n   * Adds CSS class to an element\n   */\n  ss.addClass = function(elem, name) {\n    \"use strict\";\n\n    if (!elem || !name) {\n      return false;\n    }\n\n    if (!ss.hasClass(elem, name)) {\n      elem.className += \" \" + name;\n    }\n  };\n\n  /**\n   * Removes CSS class from an element\n   */\n  ss.removeClass = (function() {\n    \"use strict\";\n\n    var c = {}; //cache regexps for performance\n\n    return function(e, name) {\n      if (!e || !name) {\n        return false;\n      }\n\n      if (!c[name]) {\n        c[name] = new RegExp(\"(?:^|\\\\s)\" + name + \"(?!\\\\S)\");\n      }\n\n      e.className = e.className.replace(c[name], \"\");\n    };\n  })();\n\n  /**\n   * Nulls out event handlers to prevent memory leaks in IE6/IE7\n   * http://javascript.crockford.com/memory/leak.html\n   * @param {Element} d\n   * @return void\n   */\n  ss.purge = function(d) {\n    \"use strict\";\n\n    var a = d.attributes,\n      i,\n      l,\n      n;\n\n    if (a) {\n      for (i = a.length - 1; i >= 0; i -= 1) {\n        n = a[i].name;\n\n        if (typeof d[n] === \"function\") {\n          d[n] = null;\n        }\n      }\n    }\n\n    a = d.childNodes;\n\n    if (a) {\n      l = a.length;\n      for (i = 0; i < l; i += 1) {\n        ss.purge(d.childNodes[i]);\n      }\n    }\n  };\n\n  /**\n   * Removes element from the DOM\n   */\n  ss.remove = function(elem) {\n    \"use strict\";\n\n    if (elem && elem.parentNode) {\n      // null out event handlers for IE\n      ss.purge(elem);\n      elem.parentNode.removeChild(elem);\n    }\n    elem = null;\n  };\n\n  /**\n   * Accepts either a jQuery object, a string containing an element ID, or an element,\n   * verifies that it exists, and returns the element.\n   * @param {Mixed} elem\n   * @return {Element}\n   */\n  ss.verifyElem = function(elem) {\n    \"use strict\";\n    /*globals jQuery */\n\n    if (typeof jQuery !== \"undefined\" && elem instanceof jQuery) {\n      elem = elem[0];\n    } else if (typeof elem === \"string\") {\n      if (elem.charAt(0) == \"#\") {\n        elem = elem.substr(1);\n      }\n      elem = document.getElementById(elem);\n    }\n\n    if (!elem || elem.nodeType !== 1) {\n      return false;\n    }\n\n    if (elem.nodeName.toUpperCase() == \"A\") {\n      elem.style.cursor = \"pointer\";\n\n      ss.addEvent(elem, \"click\", function(e) {\n        if (e && e.preventDefault) {\n          e.preventDefault();\n        } else if (window.event) {\n          window.event.returnValue = false;\n        }\n      });\n    }\n\n    return elem;\n  };\n\n  ss._options = {};\n\n  ss.uploadSetup = function(options) {\n    \"use strict\";\n    ss.extendObj(ss._options, options);\n  };\n\n  ss.SimpleUpload = function(options) {\n    \"use strict\";\n\n    this._opts = {\n      button: \"\",\n      url: \"\",\n      dropzone: \"\",\n      dragClass: \"\",\n      form: \"\",\n      overrideSubmit: true,\n      cors: false,\n      withCredentials: false,\n      progressUrl: false,\n      sessionProgressUrl: false,\n      nginxProgressUrl: false,\n      multiple: false, // allow multiple, concurrent file uploads\n      multipleSelect: false, // allow multiple file selection\n      maxUploads: 3,\n      queue: true,\n      checkProgressInterval: 500,\n      keyParamName: \"APC_UPLOAD_PROGRESS\",\n      sessionProgressName: \"PHP_SESSION_UPLOAD_PROGRESS\",\n      nginxProgressHeader: \"X-Progress-ID\",\n      customProgressHeaders: {},\n      corsInputName: \"XHR_CORS_TARGETORIGIN\",\n      allowedExtensions: [],\n      accept: \"\",\n      maxSize: false,\n      name: \"\",\n      data: {},\n      noParams: true,\n      autoSubmit: true,\n      multipart: true,\n      method: \"POST\",\n      responseType: \"\",\n      debug: false,\n      hoverClass: \"\",\n      focusClass: \"\",\n      disabledClass: \"\",\n      customHeaders: {},\n      encodeHeaders: true,\n      autoCalibrate: true,\n      onBlankSubmit: function() {},\n      onAbort: function(filename, uploadBtn, size) {},\n      onChange: function(filename, extension, uploadBtn, size, file) {},\n      onSubmit: function(filename, extension, uploadBtn, size) {},\n      onProgress: function(pct) {},\n      onUpdateFileSize: function(filesize) {},\n      onComplete: function(filename, response, uploadBtn, size) {},\n      onDone: function(\n        filename,\n        status,\n        textStatus,\n        response,\n        uploadBtn,\n        size\n      ) {},\n      onAllDone: function() {},\n      onExtError: function(filename, extension) {},\n      onSizeError: function(filename, fileSize, uploadBtn) {},\n      onError: function(\n        filename,\n        type,\n        status,\n        statusText,\n        response,\n        uploadBtn,\n        size\n      ) {},\n      startXHR: function(filename, fileSize, uploadBtn) {},\n      endXHR: function(filename, fileSize, uploadBtn) {},\n      startNonXHR: function(filename, uploadBtn) {},\n      endNonXHR: function(filename, uploadBtn) {}\n    };\n\n    ss.extendObj(this._opts, ss._options); // Include any setup options\n    ss.extendObj(this._opts, options); // Then add options for this instance\n\n    // An array of objects, each containing two items: a file and a reference\n    // to the button which triggered the upload: { file: uploadFile, btn: button }\n    this._queue = [];\n\n    this._active = 0;\n    this._disabled = false; // if disabled, clicking on button won't do anything\n    this._maxFails = 10; // max allowed failed progress updates requests in iframe mode\n    this._progKeys = {}; // contains the currently active upload ID progress keys\n    this._sizeFlags = {}; // Cache progress keys after setting sizeBox for fewer trips to the DOM\n    this._btns = [];\n\n    this.addButton(this._opts.button);\n\n    delete this._opts.button;\n    this._opts.button = options = null;\n\n    if (this._opts.multiple === false) {\n      this._opts.maxUploads = 1;\n    }\n\n    if (this._opts.dropzone !== \"\") {\n      this.addDZ(this._opts.dropzone);\n    }\n\n    if (this._opts.dropzone === \"\" && this._btns.length < 1) {\n      throw new Error(\n        \"Invalid upload button. Make sure the element you're passing exists.\"\n      );\n    }\n\n    if (this._opts.form !== \"\") {\n      this.setForm(this._opts.form);\n    }\n\n    this._createInput();\n    this._manDisabled = false;\n    this.enable(true);\n  };\n\n  ss.SimpleUpload.prototype = {\n    destroy: function() {\n      \"use strict\";\n\n      // # of upload buttons\n      var i = this._btns.length;\n\n      // Put upload buttons back to the way we found them\n      while (i--) {\n        // Remove event listener\n        if (this._btns[i].off) {\n          this._btns[i].off();\n        }\n\n        // Remove any lingering classes\n        ss.removeClass(this._btns[i], this._opts.hoverClass);\n        ss.removeClass(this._btns[i], this._opts.focusClass);\n        ss.removeClass(this._btns[i], this._opts.disabledClass);\n\n        // In case we disabled it\n        this._btns[i].disabled = false;\n      }\n\n      this._killInput();\n\n      // Set a flag to be checked in _last()\n      this._destroy = true;\n    },\n\n    /**\n     * Send data to browser console if debug is set to true\n     */\n    log: function(str) {\n      \"use strict\";\n\n      if (\n        this._opts &&\n        this._opts.debug &&\n        window.console &&\n        window.console.log\n      ) {\n        window.console.log(\"[Uploader] \" + str);\n      }\n    },\n\n    /**\n     * Replaces user data\n     * Note that all previously set data is entirely removed and replaced\n     */\n    setData: function(data) {\n      \"use strict\";\n      this._opts.data = data;\n    },\n\n    /**\n     * Set or change uploader options\n     * @param {Object} options\n     */\n    setOptions: function(options) {\n      \"use strict\";\n      ss.extendObj(this._opts, options);\n    },\n\n    /**\n     * Designate an element as an upload button\n     */\n    addButton: function(button) {\n      var btn;\n\n      // An array of buttons was passed\n      if (button instanceof Array) {\n        for (var i = 0, len = button.length; i < len; i++) {\n          btn = ss.verifyElem(button[i]);\n\n          if (btn !== false) {\n            this._btns.push(this.rerouteClicks(btn));\n          } else {\n            this.log(\"Button with array index \" + i + \" is invalid\");\n          }\n        }\n\n        // A single button was passed\n      } else {\n        btn = ss.verifyElem(button);\n\n        if (btn !== false) {\n          this._btns.push(this.rerouteClicks(btn));\n        }\n      }\n    },\n\n    /**\n     * Designate an element as a drop zone\n     */\n    addDZ: function(dropzone) {\n      if (!XhrOk) {\n        return;\n      }\n\n      dropzone = ss.verifyElem(dropzone);\n\n      if (!dropzone) {\n        this.log(\"Invalid or nonexistent element passed for drop zone\");\n      } else {\n        this.addDropZone(dropzone);\n      }\n    },\n\n    /**\n     * Designate an element as a progress bar\n     * The CSS width % of the element will be updated as the upload progresses\n     */\n    setProgressBar: function(elem) {\n      \"use strict\";\n      this._progBar = ss.verifyElem(elem);\n    },\n\n    /**\n     * Designate an element to receive a string containing progress % during upload\n     * Note: Uses innerHTML, so any existing child elements will be wiped out\n     */\n    setPctBox: function(elem) {\n      \"use strict\";\n      this._pctBox = ss.verifyElem(elem);\n    },\n\n    /**\n     * Designate an element to receive a string containing file size at start of upload\n     * Note: Uses innerHTML, so any existing child elements will be wiped out\n     */\n    setFileSizeBox: function(elem) {\n      \"use strict\";\n      this._sizeBox = ss.verifyElem(elem);\n    },\n\n    /**\n     * Designate an element to be removed from DOM when upload is completed\n     * Useful for removing progress bar, file size, etc. after upload\n     */\n    setProgressContainer: function(elem) {\n      \"use strict\";\n      this._progBox = ss.verifyElem(elem);\n    },\n\n    /**\n     * Designate an element to serve as the upload abort button\n     */\n    setAbortBtn: function(elem, remove) {\n      \"use strict\";\n\n      this._abortBtn = ss.verifyElem(elem);\n      this._removeAbort = false;\n\n      if (remove) {\n        this._removeAbort = true;\n      }\n    },\n\n    setForm: function(form) {\n      \"use strict\";\n\n      this._form = ss.verifyElem(form);\n\n      if (!this._form || this._form.nodeName.toUpperCase() != \"FORM\") {\n        this.log(\"Invalid or nonexistent element passed for form\");\n      } else {\n        var self = this;\n        this._opts.autoSubmit = false;\n\n        if (this._opts.overrideSubmit) {\n          ss.addEvent(this._form, \"submit\", function(e) {\n            if (e.preventDefault) {\n              e.preventDefault();\n            } else if (window.event) {\n              window.event.returnValue = false;\n            }\n\n            if (self._validateForm()) {\n              self.submit();\n            }\n          });\n\n          this._form.submit = function() {\n            if (self._validateForm()) {\n              self.submit();\n            }\n          };\n        }\n      }\n    },\n\n    /**\n     * Returns number of files currently in queue\n     */\n    getQueueSize: function() {\n      \"use strict\";\n      return this._queue.length;\n    },\n\n    /**\n     * Remove current file from upload queue, reset props, cycle to next upload\n     */\n    removeCurrent: function(id) {\n      \"use strict\";\n\n      if (id) {\n        var i = this._queue.length;\n\n        while (i--) {\n          if (this._queue[i].id === id) {\n            this._queue.splice(i, 1);\n            break;\n          }\n        }\n      } else {\n        this._queue.splice(0, 1);\n      }\n\n      this._cycleQueue();\n    },\n\n    /**\n     * Clears Queue so only most recent select file is uploaded\n     */\n    clearQueue: function() {\n      \"use strict\";\n      this._queue.length = 0;\n    },\n\n    /**\n     * Disables upload functionality\n     */\n    disable: function(_self) {\n      \"use strict\";\n\n      var i = this._btns.length,\n        nodeName;\n\n      // _self is always true when disable() is called internally\n      this._manDisabled = !_self || this._manDisabled === true ? true : false;\n      this._disabled = true;\n\n      while (i--) {\n        nodeName = this._btns[i].nodeName.toUpperCase();\n\n        if (nodeName == \"INPUT\" || nodeName == \"BUTTON\") {\n          this._btns[i].disabled = true;\n        }\n\n        if (this._opts.disabledClass !== \"\") {\n          ss.addClass(this._btns[i], this._opts.disabledClass);\n        }\n      }\n\n      // Hide file input\n      if (this._input && this._input.parentNode) {\n        this._input.parentNode.style.visibility = \"hidden\";\n      }\n    },\n\n    /**\n     * Enables upload functionality\n     */\n    enable: function(_self) {\n      \"use strict\";\n\n      // _self will always be true when enable() is called internally\n      if (!_self) {\n        this._manDisabled = false;\n      }\n\n      // Don't enable uploader if it was manually disabled\n      if (this._manDisabled === true) {\n        return;\n      }\n\n      var i = this._btns.length;\n\n      this._disabled = false;\n\n      while (i--) {\n        ss.removeClass(this._btns[i], this._opts.disabledClass);\n        this._btns[i].disabled = false;\n      }\n    },\n\n    /**\n     * Updates invisible button position\n     */\n    updatePosition: function(btn) {\n      \"use strict\";\n\n      btn = !btn ? this._btns[0] : btn;\n\n      if (btn && this._input && this._input.parentNode) {\n        ss.copyLayout(btn, this._input.parentNode);\n      }\n\n      btn = null;\n    },\n\n    rerouteClicks: function(elem) {\n      \"use strict\";\n\n      var self = this,\n        detachOver,\n        detachClick;\n\n      detachOver = ss.addEvent(elem, \"mouseover\", function() {\n        if (self._disabled) {\n          return;\n        }\n\n        if (!self._input) {\n          self._createInput();\n        }\n\n        self._overBtn = elem;\n        ss.copyLayout(elem, self._input.parentNode);\n        self._input.parentNode.style.visibility = \"visible\";\n      });\n\n      // Support keyboard interaction\n      detachClick = ss.addEvent(elem, \"click\", function(e) {\n        if (e && e.preventDefault) {\n          e.preventDefault();\n        }\n\n        if (self._disabled) {\n          return;\n        }\n\n        if (!self._input) {\n          self._createInput();\n        }\n\n        self._overBtn = elem;\n\n        if (!isIE7to9) {\n          self._input.click();\n        }\n      });\n\n      // ss.addEvent() returns a function to detach, which\n      // allows us to call elem.off() to remove mouseover listener\n      elem.off = function() {\n        detachOver();\n        detachClick();\n      };\n\n      if (self._opts.autoCalibrate && !ss.isVisible(elem)) {\n        self.log(\"Upload button not visible\");\n\n        var interval = function() {\n          if (ss.isVisible(elem)) {\n            self.log(\"Upload button now visible\");\n\n            window.setTimeout(function() {\n              self.updatePosition(elem);\n\n              if (self._btns.length === 1) {\n                self._input.parentNode.style.visibility = \"hidden\";\n              }\n            }, 200);\n          } else {\n            window.setTimeout(interval, 500);\n          }\n        };\n\n        window.setTimeout(interval, 500);\n      }\n\n      return elem;\n    },\n\n    /**\n     * Validates input and directs to either XHR method or iFrame method\n     */\n    submit: function(_, auto) {\n      \"use strict\";\n\n      if (!auto && this._queue.length < 1) {\n        this._opts.onBlankSubmit.call(this);\n        return;\n      }\n\n      if (\n        this._disabled ||\n        this._active >= this._opts.maxUploads ||\n        this._queue.length < 1\n      ) {\n        return;\n      }\n\n      if (!this._checkFile(this._queue[0])) {\n        return;\n      }\n\n      // User returned false to cancel upload\n      if (\n        false ===\n        this._opts.onSubmit.call(\n          this,\n          this._queue[0].name,\n          this._queue[0].ext,\n          this._queue[0].btn,\n          this._queue[0].size\n        )\n      ) {\n        this.removeCurrent(this._queue[0].id);\n        return;\n      }\n\n      // Increment the active upload counter\n      this._active++;\n\n      // Disable uploading if multiple file uploads are not enabled\n      // or if queue is disabled and we've reached max uploads\n      if (\n        this._opts.multiple === false ||\n        (this._opts.queue === false && this._active >= this._opts.maxUploads)\n      ) {\n        this.disable(true);\n      }\n\n      this._initUpload(this._queue[0]);\n    }\n  };\n\n  ss.IframeUpload = {\n    _detachEvents: {},\n\n    _detach: function(id) {\n      if (this._detachEvents[id]) {\n        this._detachEvents[id]();\n        delete this._detachEvents[id];\n      }\n    },\n\n    /**\n     * Accepts a URI string and returns the hostname\n     */\n    _getHost: function(uri) {\n      var a = document.createElement(\"a\");\n\n      a.href = uri;\n\n      if (a.hostname) {\n        return a.hostname.toLowerCase();\n      }\n      return uri;\n    },\n\n    _addFiles: function(file) {\n      var filename = ss.getFilename(file.value),\n        ext = ss.getExt(filename);\n\n      if (\n        false ===\n        this._opts.onChange.call(\n          this,\n          filename,\n          ext,\n          this._overBtn,\n          undefined,\n          file\n        )\n      ) {\n        return false;\n      }\n\n      this._queue.push({\n        id: ss.getUID(),\n        file: file,\n        name: filename,\n        ext: ext,\n        btn: this._overBtn,\n        size: null\n      });\n\n      return true;\n    },\n\n    /**\n     * Handles uploading with iFrame\n     */\n    _uploadIframe: function(\n      fileObj,\n      progBox,\n      sizeBox,\n      progBar,\n      pctBox,\n      abortBtn,\n      removeAbort\n    ) {\n      \"use strict\";\n\n      var self = this,\n        opts = this._opts,\n        key = ss.getUID(),\n        iframe = ss.getIFrame(),\n        form,\n        url,\n        msgLoaded = false,\n        iframeLoaded = false,\n        cancel;\n\n      if (opts.noParams === true) {\n        url = opts.url;\n      } else {\n        // If we're using Nginx Upload Progress Module, append upload key to the URL\n        // Also, preserve query string if there is one\n        url = !opts.nginxProgressUrl\n          ? opts.url\n          : url +\n            (url.indexOf(\"?\") > -1 ? \"&\" : \"?\") +\n            encodeURIComponent(opts.nginxProgressHeader) +\n            \"=\" +\n            encodeURIComponent(key);\n      }\n\n      form = ss.getForm({\n        action: url,\n        target: iframe.name,\n        method: opts.method\n      });\n\n      opts.onProgress.call(this, 0);\n\n      if (pctBox) {\n        pctBox.innerHTML = \"0%\";\n      }\n\n      if (progBar) {\n        progBar.style.width = \"0%\";\n      }\n\n      // For CORS, add a listener for the \"message\" event, which will be\n      // triggered by the Javascript snippet in the server response\n      if (opts.cors) {\n        var msgId = ss.getUID();\n\n        self._detachEvents[msgId] = ss.addEvent(window, \"message\", function(\n          event\n        ) {\n          // Make sure event.origin matches the upload URL\n          if (self._getHost(event.origin) != self._getHost(opts.url)) {\n            self.log(\"Non-matching origin: \" + event.origin);\n            return;\n          }\n\n          msgLoaded = true;\n          self._detach(msgId);\n          opts.endNonXHR.call(self, fileObj.name, fileObj.btn);\n          self._finish(\n            fileObj,\n            \"\",\n            \"\",\n            event.data,\n            sizeBox,\n            progBox,\n            pctBox,\n            abortBtn,\n            removeAbort\n          );\n        });\n      }\n\n      self._detachEvents[iframe.id] = ss.addEvent(iframe, \"load\", function() {\n        self._detach(iframe.id);\n\n        if (opts.sessionProgressUrl) {\n          form.appendChild(ss.getHidden(opts.sessionProgressName, key));\n        }\n\n        // PHP APC upload progress key field must come before the file field\n        else if (opts.progressUrl) {\n          form.appendChild(ss.getHidden(opts.keyParamName, key));\n        }\n\n        if (self._form) {\n          ss.extendObj(opts.data, ss.getFormObj(self._form));\n        }\n\n        // Get additional data after startNonXHR() in case setData() was called prior to submitting\n        for (var prop in opts.data) {\n          if (opts.data.hasOwnProperty(prop)) {\n            form.appendChild(ss.getHidden(prop, opts.data[prop]));\n          }\n        }\n\n        // Add a field (default name: \"XHR_CORS_TRARGETORIGIN\") to tell server this is a CORS request\n        // Value of the field is targetOrigin parameter of postMessage(message, targetOrigin)\n        if (opts.cors) {\n          form.appendChild(\n            ss.getHidden(opts.corsInputName, window.location.href)\n          );\n        }\n\n        form.appendChild(fileObj.file);\n\n        self._detachEvents[fileObj.id] = ss.addEvent(\n          iframe,\n          \"load\",\n          function() {\n            if (!iframe || !iframe.parentNode || iframeLoaded) {\n              return;\n            }\n\n            self._detach(fileObj.id);\n            iframeLoaded = true;\n\n            delete self._progKeys[key];\n            delete self._sizeFlags[key];\n\n            if (abortBtn) {\n              ss.removeEvent(abortBtn, \"click\", cancel);\n            }\n\n            // After a CORS response, we wait briefly for the \"message\" event to finish,\n            // during which time the msgLoaded var will be set to true, signalling success.\n            // If iframe loads without \"message\" event, we assume there was an error\n            if (opts.cors) {\n              window.setTimeout(function() {\n                ss.remove(iframe);\n\n                // If msgLoaded has not been set to true after \"message\" event fires, we\n                // infer that an error must have occurred and respond accordingly\n                if (!msgLoaded) {\n                  self._errorFinish(\n                    fileObj,\n                    \"\",\n                    \"\",\n                    false,\n                    \"error\",\n                    progBox,\n                    sizeBox,\n                    pctBox,\n                    abortBtn,\n                    removeAbort\n                  );\n                }\n\n                opts = key = iframe = sizeBox = progBox = pctBox = abortBtn = removeAbort = null;\n              }, 600);\n            }\n\n            // Non-CORS upload\n            else {\n              try {\n                var doc = iframe.contentDocument\n                    ? iframe.contentDocument\n                    : iframe.contentWindow.document,\n                  response = doc.body.innerHTML;\n\n                ss.remove(iframe);\n                iframe = null;\n\n                opts.endNonXHR.call(self, fileObj.name, fileObj.btn);\n\n                // No way to get status and statusText for an iframe so return empty strings\n                self._finish(\n                  fileObj,\n                  \"\",\n                  \"\",\n                  response,\n                  sizeBox,\n                  progBox,\n                  pctBox,\n                  abortBtn,\n                  removeAbort\n                );\n              } catch (e) {\n                self._errorFinish(\n                  fileObj,\n                  \"\",\n                  e.message,\n                  false,\n                  \"error\",\n                  progBox,\n                  sizeBox,\n                  pctBox,\n                  abortBtn,\n                  removeAbort\n                );\n              }\n\n              opts = key = sizeBox = progBox = pctBox = null;\n            }\n          }\n        ); // end load\n\n        if (abortBtn) {\n          cancel = function() {\n            ss.removeEvent(abortBtn, \"click\", cancel);\n\n            delete self._progKeys[key];\n            delete self._sizeFlags[key];\n\n            if (iframe) {\n              iframeLoaded = true;\n              self._detach(fileObj.id);\n\n              try {\n                if (iframe.contentWindow.document.execCommand) {\n                  iframe.contentWindow.document.execCommand(\"Stop\");\n                }\n              } catch (err) {}\n\n              try {\n                iframe.src = \"javascript\".concat(\":false;\");\n              } catch (err) {}\n\n              window.setTimeout(function() {\n                ss.remove(iframe);\n                iframe = null;\n              }, 1);\n            }\n\n            self.log(\"Upload aborted\");\n            opts.onAbort.call(self, fileObj.name, fileObj.btn, fileObj.size);\n            self._last(\n              sizeBox,\n              progBox,\n              pctBox,\n              abortBtn,\n              removeAbort,\n              fileObj,\n              \"abort\"\n            );\n          };\n\n          ss.addEvent(abortBtn, \"click\", cancel);\n        }\n\n        self.log(\"Commencing upload using iframe\");\n        form.submit();\n\n        // Remove form and begin next upload\n        window.setTimeout(function() {\n          ss.remove(form);\n          form = null;\n          self.removeCurrent(fileObj.id);\n        }, 1);\n\n        if (self._hasProgUrl) {\n          // Add progress key to active key array\n          self._progKeys[key] = 1;\n\n          window.setTimeout(function() {\n            self._getProg(key, progBar, sizeBox, pctBox, 1);\n            progBar = sizeBox = pctBox = null;\n          }, 600);\n        }\n      }); // end load\n\n      document.body.appendChild(form);\n      document.body.appendChild(iframe);\n    },\n\n    /**\n     * Retrieves upload progress updates from the server\n     * (For fallback upload progress support)\n     */\n    _getProg: function(key, progBar, sizeBox, pctBox, counter) {\n      \"use strict\";\n      /*jshint sub:true*/\n\n      var self = this,\n        opts = this._opts,\n        time = new Date().getTime(),\n        xhr,\n        url,\n        callback;\n\n      if (!key || !opts) {\n        return;\n      }\n\n      // Nginx Upload Progress Module\n      if (opts.nginxProgressUrl) {\n        url =\n          opts.nginxProgressUrl +\n          \"?\" +\n          encodeURIComponent(opts.nginxProgressHeader) +\n          \"=\" +\n          encodeURIComponent(key) +\n          \"&_=\" +\n          time;\n      } else if (opts.sessionProgressUrl) {\n        url = opts.sessionProgressUrl;\n      }\n\n      // PHP APC upload progress\n      else if (opts.progressUrl) {\n        url =\n          opts.progressUrl +\n          \"?progresskey=\" +\n          encodeURIComponent(key) +\n          \"&_=\" +\n          time;\n      }\n\n      callback = function() {\n        var response, size, pct, status, statusText;\n\n        try {\n          // XDR doesn't have readyState so we just assume that it finished correctly\n          if (callback && (opts.cors || xhr.readyState === 4)) {\n            callback = undefined;\n            xhr.onreadystatechange = function() {};\n\n            try {\n              statusText = xhr.statusText;\n              status = xhr.status;\n            } catch (e) {\n              statusText = \"\";\n              status = \"\";\n            }\n\n            // XDR also doesn't have status, so just assume that everything is fine\n            if (opts.cors || (status >= 200 && status < 300)) {\n              response = ss.parseJSON(xhr.responseText);\n\n              if (response === false) {\n                self.log(\"Error parsing progress response (expecting JSON)\");\n                return;\n              }\n\n              // Handle response if using Nginx Upload Progress Module\n              if (opts.nginxProgressUrl) {\n                if (response.state == \"uploading\") {\n                  size = parseInt(response.size, 10);\n                  if (size > 0) {\n                    pct = Math.round(\n                      (parseInt(response.received, 10) / size) * 100\n                    );\n                    size = Math.round(size / 1024); // convert to kilobytes\n                  }\n                } else if (response.state == \"done\") {\n                  pct = 100;\n                } else if (response.state == \"error\") {\n                  self.log(\n                    \"Error requesting upload progress: \" + response.status\n                  );\n                  return;\n                }\n              }\n\n              // Handle response if using PHP APC\n              else if (opts.sessionProgressUrl || opts.progressUrl) {\n                if (response.success === true) {\n                  size = parseInt(response.size, 10);\n                  pct = parseInt(response.pct, 10);\n                }\n              }\n\n              // Update progress bar width\n              if (pct) {\n                if (pctBox) {\n                  pctBox.innerHTML = pct + \"%\";\n                }\n\n                if (progBar) {\n                  progBar.style.width = pct + \"%\";\n                }\n\n                opts.onProgress.call(self, pct);\n              }\n\n              if (size && !self._sizeFlags[key]) {\n                if (sizeBox) {\n                  sizeBox.innerHTML = size + \"K\";\n                }\n\n                self._sizeFlags[key] = 1;\n                opts.onUpdateFileSize.call(self, size);\n              }\n\n              // Stop attempting progress checks if we keep failing\n              if (!pct && !size && counter >= self._maxFails) {\n                counter++;\n                self.log(\n                  \"Failed progress request limit reached. Count: \" + counter\n                );\n                return;\n              }\n\n              // Begin countdown until next progress update check\n              if (pct < 100 && self._progKeys[key]) {\n                window.setTimeout(function() {\n                  self._getProg(key, progBar, sizeBox, pctBox, counter);\n\n                  key = progBar = sizeBox = pctBox = counter = null;\n                }, opts.checkProgressInterval);\n              }\n\n              // We didn't get a 2xx status so don't continue sending requests\n            } else {\n              delete self._progKeys[key];\n              self.log(\n                \"Error requesting upload progress: \" + status + \" \" + statusText\n              );\n            }\n\n            xhr = size = pct = status = statusText = response = null;\n          }\n        } catch (e) {\n          self.log(\"Error requesting upload progress: \" + e.message);\n        }\n      };\n\n      // CORS requests in IE8 and IE9 must use XDomainRequest\n      if (opts.cors && !opts.sessionProgressUrl) {\n        if (window.XDomainRequest) {\n          xhr = new window.XDomainRequest();\n          xhr.open(\"GET\", url, true);\n          xhr.onprogress = xhr.ontimeout = function() {};\n          xhr.onload = callback;\n\n          xhr.onerror = function() {\n            delete self._progKeys[key];\n            key = null;\n            self.log(\"Error requesting upload progress\");\n          };\n\n          // IE7 or some other dinosaur -- just give up\n        } else {\n          return;\n        }\n      } else {\n        var method = !opts.sessionProgressUrl ? \"GET\" : \"POST\",\n          headers = {},\n          params;\n\n        xhr = ss.newXHR();\n        xhr.onreadystatechange = callback;\n        xhr.open(method, url, true);\n\n        // PHP session progress updates must be a POST request\n        if (opts.sessionProgressUrl) {\n          params =\n            encodeURIComponent(opts.sessionProgressName) +\n            \"=\" +\n            encodeURIComponent(key);\n          headers[\"Content-Type\"] = \"application/x-www-form-urlencoded\";\n        }\n\n        // Set the upload progress header for Nginx\n        if (opts.nginxProgressUrl) {\n          headers[opts.nginxProgressHeader] = key;\n        }\n\n        headers[\"X-Requested-With\"] = \"XMLHttpRequest\";\n        headers[\"Accept\"] = \"application/json, text/javascript, */*; q=0.01\";\n\n        ss.extendObj(headers, opts.customProgressHeaders);\n\n        for (var i in headers) {\n          if (headers.hasOwnProperty(i)) {\n            if (opts.encodeHeaders) {\n              xhr.setRequestHeader(i, ss.encodeUTF8(headers[i] + \"\"));\n            } else {\n              xhr.setRequestHeader(i, headers[i] + \"\");\n            }\n          }\n        }\n\n        xhr.send((opts.sessionProgressUrl && params) || null);\n      }\n    },\n\n    _initUpload: function(fileObj) {\n      if (\n        false === this._opts.startNonXHR.call(this, fileObj.name, fileObj.btn)\n      ) {\n        if (this._disabled) {\n          this.enable(true);\n        }\n\n        this._active--;\n        return;\n      }\n\n      this._hasProgUrl =\n        this._opts.progressUrl ||\n        this._opts.sessionProgressUrl ||\n        this._opts.nginxProgressUrl\n          ? true\n          : false;\n\n      this._uploadIframe(\n        fileObj,\n        this._progBox,\n        this._sizeBox,\n        this._progBar,\n        this._pctBox,\n        this._abortBtn,\n        this._removeAbort\n      );\n\n      fileObj = this._progBox = this._sizeBox = this._progBar = this._pctBox = this._abortBtn = this._removeAbort = null;\n    }\n  };\n\n  ss.XhrUpload = {\n    _addFiles: function(files) {\n      var total = files.length,\n        filename,\n        ext,\n        size,\n        i;\n\n      if (!this._opts.multiple) {\n        total = 1;\n      }\n\n      for (i = 0; i < total; i++) {\n        filename = ss.getFilename(files[i].name);\n        ext = ss.getExt(filename);\n        size = Math.round(files[i].size / 1024);\n\n        if (\n          false ===\n          this._opts.onChange.call(\n            this,\n            filename,\n            ext,\n            this._overBtn,\n            size,\n            files[i]\n          )\n        ) {\n          return false;\n        }\n\n        this._queue.push({\n          id: ss.getUID(),\n          file: files[i],\n          name: filename,\n          ext: ext,\n          btn: this._overBtn,\n          size: size\n        });\n      }\n\n      return true;\n    },\n\n    /**\n     * Handles uploading with XHR\n     */\n    _uploadXhr: function(\n      fileObj,\n      url,\n      params,\n      headers,\n      sizeBox,\n      progBar,\n      progBox,\n      pctBox,\n      abortBtn,\n      removeAbort\n    ) {\n      \"use strict\";\n\n      var self = this,\n        opts = this._opts,\n        xhr = ss.newXHR(),\n        callback,\n        cancel;\n\n      // Inject file size into size box\n      if (sizeBox) {\n        sizeBox.innerHTML = fileObj.size + \"K\";\n      }\n\n      // Begin progress bars at 0%\n      if (pctBox) {\n        pctBox.innerHTML = \"0%\";\n      }\n\n      if (progBar) {\n        progBar.style.width = \"0%\";\n      }\n\n      // Borrows heavily from jQuery ajax transport\n      callback = function(_, isAbort) {\n        var statusText;\n\n        try {\n          // Was never called and is aborted or complete\n          if (callback && (isAbort || xhr.readyState === 4)) {\n            callback = undefined;\n            xhr.onreadystatechange = function() {};\n\n            // If it's an abort\n            if (isAbort) {\n              // Abort it manually if needed\n              if (xhr.readyState !== 4) {\n                xhr.abort();\n              }\n\n              opts.onAbort.call(self, fileObj.name, fileObj.btn, fileObj.size);\n              self._last(\n                sizeBox,\n                progBox,\n                pctBox,\n                abortBtn,\n                removeAbort,\n                fileObj,\n                \"abort\"\n              );\n            } else {\n              if (abortBtn) {\n                ss.removeEvent(abortBtn, \"click\", cancel);\n              }\n\n              try {\n                statusText = xhr.statusText;\n              } catch (e) {\n                // We normalize with Webkit giving an empty statusText\n                statusText = \"\";\n              }\n\n              if (xhr.status >= 200 && xhr.status < 300) {\n                opts.endXHR.call(self, fileObj.name, fileObj.size, fileObj.btn);\n                self._finish(\n                  fileObj,\n                  xhr.status,\n                  statusText,\n                  xhr.responseText,\n                  sizeBox,\n                  progBox,\n                  pctBox,\n                  abortBtn,\n                  removeAbort\n                );\n\n                // We didn't get a 2xx status so throw an error\n              } else {\n                self._errorFinish(\n                  fileObj,\n                  xhr.status,\n                  statusText,\n                  xhr.responseText,\n                  \"error\",\n                  progBox,\n                  sizeBox,\n                  pctBox,\n                  abortBtn,\n                  removeAbort\n                );\n              }\n            }\n          }\n        } catch (e) {\n          if (!isAbort) {\n            self._errorFinish(\n              fileObj,\n              -1,\n              e.message,\n              false,\n              \"error\",\n              progBox,\n              sizeBox,\n              pctBox,\n              abortBtn,\n              removeAbort\n            );\n          }\n        }\n      };\n\n      if (abortBtn) {\n        cancel = function() {\n          ss.removeEvent(abortBtn, \"click\", cancel);\n\n          if (callback) {\n            callback(undefined, true);\n          }\n        };\n\n        ss.addEvent(abortBtn, \"click\", cancel);\n      }\n\n      xhr.onreadystatechange = callback;\n      xhr.open(opts.method.toUpperCase(), url, true);\n      xhr.withCredentials = !!opts.withCredentials;\n\n      ss.extendObj(headers, opts.customHeaders);\n\n      for (var i in headers) {\n        if (headers.hasOwnProperty(i)) {\n          if (opts.encodeHeaders) {\n            xhr.setRequestHeader(i, ss.encodeUTF8(headers[i] + \"\"));\n          } else {\n            xhr.setRequestHeader(i, headers[i] + \"\");\n          }\n        }\n      }\n\n      ss.addEvent(xhr.upload, \"progress\", function(event) {\n        if (event.lengthComputable) {\n          var pct = Math.round((event.loaded / event.total) * 100);\n\n          opts.onProgress.call(self, pct);\n\n          if (pctBox) {\n            pctBox.innerHTML = pct + \"%\";\n          }\n\n          if (progBar) {\n            progBar.style.width = pct + \"%\";\n          }\n        }\n      });\n\n      opts.onProgress.call(this, 0);\n\n      if (opts.multipart === true) {\n        var formData = new FormData();\n\n        var hasFile = false;\n\n        for (var prop in params) {\n          if (params.hasOwnProperty(prop)) {\n            if (prop === opts.name && opts.noParams === true && !self._form) {\n              hasFile = true;\n            }\n            formData.append(prop, params[prop]);\n          }\n        }\n\n        if (!hasFile) {\n          formData.append(opts.name, fileObj.file);\n        }\n\n        this.log(\"Commencing upload using multipart form\");\n        xhr.send(formData);\n      } else {\n        this.log(\"Commencing upload using binary stream\");\n        xhr.send(fileObj.file);\n      }\n\n      // Remove file from upload queue and begin next upload\n      this.removeCurrent(fileObj.id);\n    },\n\n    _initUpload: function(fileObj) {\n      \"use strict\";\n      /*jshint sub:true*/\n\n      var params = {},\n        headers = {},\n        url;\n\n      // Call the startXHR() callback and stop upload if it returns false\n      // We call it before _uploadXhr() in case setProgressBar, setPctBox, etc., is called\n      if (\n        false ===\n        this._opts.startXHR.call(this, fileObj.name, fileObj.size, fileObj.btn)\n      ) {\n        if (this._disabled) {\n          this.enable(true);\n        }\n\n        this._active--;\n        return;\n      }\n\n      headers[\"X-Requested-With\"] = \"XMLHttpRequest\";\n      headers[\"X-File-Name\"] = ss.encodeUTF8(fileObj.name);\n\n      if (this._opts.responseType.toLowerCase() == \"json\") {\n        headers[\"Accept\"] = \"application/json, text/javascript, */*; q=0.01\";\n      }\n\n      if (!this._opts.multipart) {\n        headers[\"Content-Type\"] = \"application/octet-stream\";\n      }\n\n      if (this._form) {\n        ss.extendObj(params, ss.getFormObj(this._form));\n      }\n\n      // We get the any additional data here after startXHR()\n      ss.extendObj(params, this._opts.data);\n\n      // Build query string while preserving any existing parameters\n      url =\n        this._opts.noParams === true\n          ? this._opts.url\n          : this._opts.url +\n            (this._opts.url.indexOf(\"?\") > -1 ? \"&\" : \"?\") +\n            ss.obj2string(params);\n\n      this._uploadXhr(\n        fileObj,\n        url,\n        params,\n        headers,\n        this._sizeBox,\n        this._progBar,\n        this._progBox,\n        this._pctBox,\n        this._abortBtn,\n        this._removeAbort\n      );\n\n      this._sizeBox = this._progBar = this._progBox = this._pctBox = this._abortBtn = this._removeAbort = null;\n    }\n  };\n\n  ss.DragAndDrop = {\n    _dragFileCheck: function(e) {\n      if (e.dataTransfer.types) {\n        for (var i = 0; i < e.dataTransfer.types.length; i++) {\n          if (e.dataTransfer.types[i] == \"Files\") {\n            return true;\n          }\n        }\n      }\n\n      return false;\n    },\n\n    addDropZone: function(elem) {\n      var self = this,\n        collection = [];\n\n      ss.addStyles(elem, {\n        zIndex: 16777271\n      });\n\n      elem.ondragenter = function(e) {\n        e.stopPropagation();\n        e.preventDefault();\n\n        if (!self._dragFileCheck(e)) {\n          return false;\n        }\n\n        if (collection.length === 0) {\n          ss.addClass(this, self._opts.dragClass);\n        }\n\n        if (ss.indexOf(collection, e.target) === -1) {\n          collection.push(e.target);\n        }\n\n        return false;\n      };\n\n      elem.ondragover = function(e) {\n        e.stopPropagation();\n        e.preventDefault();\n\n        if (self._dragFileCheck(e)) {\n          e.dataTransfer.dropEffect = \"copy\";\n        }\n\n        return false;\n      };\n\n      elem.ondragend = function() {\n        ss.removeClass(this, self._opts.dragClass);\n        return false;\n      };\n\n      elem.ondragleave = function(e) {\n        ss.arrayDelete(collection, e.target);\n\n        if (collection.length === 0) {\n          ss.removeClass(this, self._opts.dragClass);\n        }\n\n        return false;\n      };\n\n      elem.ondrop = function(e) {\n        e.stopPropagation();\n        e.preventDefault();\n\n        ss.arrayDelete(collection, e.target);\n\n        if (collection.length === 0) {\n          ss.removeClass(this, self._opts.dragClass);\n        }\n\n        if (!self._dragFileCheck(e)) {\n          return;\n        }\n\n        if (false !== self._addFiles(e.dataTransfer.files)) {\n          self._cycleQueue();\n        }\n      };\n    }\n  };\n\n  ss.extendObj(ss.SimpleUpload.prototype, {\n    _createInput: function() {\n      \"use strict\";\n\n      var self = this,\n        div = document.createElement(\"div\");\n\n      this._input = document.createElement(\"input\");\n      this._input.type = \"file\";\n      this._input.name = this._opts.name;\n\n      // Don't allow multiple file selection in Safari -- it has a nasty bug\n      // http://stackoverflow.com/q/7231054/1091949\n      if (XhrOk && !isSafari && this._opts.multipleSelect) {\n        this._input.multiple = true;\n      }\n\n      // Check support for file input accept attribute\n      if (\"accept\" in this._input && this._opts.accept !== \"\") {\n        this._input.accept = this._opts.accept;\n      }\n\n      ss.addStyles(div, {\n        display: \"block\",\n        position: \"absolute\",\n        overflow: \"hidden\",\n        margin: 0,\n        padding: 0,\n        opacity: 0,\n        direction: \"ltr\",\n        zIndex: 16777270,\n        pointerEvents: \"none\"\n      });\n\n      if (div.style.opacity !== \"0\") {\n        div.style.filter = \"alpha(opacity=0)\";\n      }\n\n      ss.addStyles(this._input, {\n        position: \"absolute\",\n        right: 0,\n        margin: 0,\n        padding: 0,\n        fontSize: \"480px\",\n        fontFamily: \"sans-serif\",\n        cursor: \"pointer\",\n        height: \"100%\",\n        zIndex: 16777270\n      });\n\n      this._input.turnOff = ss.addEvent(this._input, \"change\", function() {\n        if (!self._input || self._input.value === \"\") {\n          return;\n        }\n\n        if (false === self._addFiles(XhrOk ? self._input.files : self._input)) {\n          return;\n        }\n\n        ss.removeClass(self._overBtn, self._opts.hoverClass);\n        ss.removeClass(self._overBtn, self._opts.focusClass);\n\n        self._killInput();\n\n        // Then create a new file input\n        self._createInput();\n\n        // Submit if autoSubmit option is true\n        if (self._opts.autoSubmit) {\n          self.submit();\n        }\n      });\n\n      if (self._opts.hoverClass !== \"\") {\n        div.mouseOverOff = ss.addEvent(div, \"mouseover\", function() {\n          ss.addClass(self._overBtn, self._opts.hoverClass);\n        });\n      }\n\n      div.mouseOutOff = ss.addEvent(div, \"mouseout\", function() {\n        self._input.parentNode.style.visibility = \"hidden\";\n\n        if (self._opts.hoverClass !== \"\") {\n          ss.removeClass(self._overBtn, self._opts.hoverClass);\n          ss.removeClass(self._overBtn, self._opts.focusClass);\n        }\n      });\n\n      if (self._opts.focusClass !== \"\") {\n        this._input.focusOff = ss.addEvent(this._input, \"focus\", function() {\n          ss.addClass(self._overBtn, self._opts.focusClass);\n        });\n\n        this._input.blurOff = ss.addEvent(this._input, \"blur\", function() {\n          ss.removeClass(self._overBtn, self._opts.focusClass);\n        });\n      }\n\n      div.appendChild(this._input);\n      document.body.appendChild(div);\n      div = null;\n    },\n\n    /**\n     * Final cleanup function after upload ends\n     */\n    _last: function(\n      sizeBox,\n      progBox,\n      pctBox,\n      abortBtn,\n      removeAbort,\n      fileObj,\n      textStatus,\n      status,\n      response\n    ) {\n      \"use strict\";\n\n      if (sizeBox) {\n        sizeBox.innerHTML = \"\";\n      }\n\n      if (pctBox) {\n        pctBox.innerHTML = \"\";\n      }\n\n      if (abortBtn && removeAbort) {\n        ss.remove(abortBtn);\n      }\n\n      if (progBox) {\n        ss.remove(progBox);\n      }\n\n      // Decrement the active upload counter\n      this._active--;\n\n      sizeBox = progBox = pctBox = abortBtn = removeAbort = null;\n\n      if (this._disabled) {\n        this.enable(true);\n      }\n\n      // Burn it all down if destroy() was called\n      // We have to do it here after everything is finished to avoid any errors\n      if (this._destroy && this._queue.length === 0 && this._active === 0) {\n        for (var prop in this) {\n          if (this.hasOwnProperty(prop)) {\n            delete this[prop];\n          }\n        }\n\n        // Otherwise just go to the next upload as usual\n      } else {\n        this._opts.onDone.call(\n          this,\n          fileObj.name,\n          status,\n          textStatus,\n          response,\n          fileObj.btn,\n          fileObj.size\n        );\n\n        this._cycleQueue();\n\n        if (this._queue.length === 0 && this._active === 0) {\n          this._opts.onAllDone.call(this);\n        }\n      }\n\n      fileObj = textStatus = status = response = null;\n    },\n\n    /**\n     * Completes upload request if an error is detected\n     */\n    _errorFinish: function(\n      fileObj,\n      status,\n      statusText,\n      response,\n      errorType,\n      progBox,\n      sizeBox,\n      pctBox,\n      abortBtn,\n      removeAbort\n    ) {\n      \"use strict\";\n\n      this.log(\"Upload failed: \" + status + \" \" + statusText);\n      this._opts.onError.call(\n        this,\n        fileObj.name,\n        errorType,\n        status,\n        statusText,\n        response,\n        fileObj.btn,\n        fileObj.size\n      );\n      this._last(\n        sizeBox,\n        progBox,\n        pctBox,\n        abortBtn,\n        removeAbort,\n        fileObj,\n        \"error\",\n        status,\n        response\n      );\n\n      statusText = errorType = sizeBox = progBox = pctBox = abortBtn = removeAbort = null;\n    },\n\n    /**\n     * Completes upload request if the transfer was successful\n     */\n    _finish: function(\n      fileObj,\n      status,\n      statusText,\n      response,\n      sizeBox,\n      progBox,\n      pctBox,\n      abortBtn,\n      removeAbort\n    ) {\n      \"use strict\";\n\n      this.log(\"Server response: \" + response);\n\n      if (this._opts.responseType.toLowerCase() == \"json\") {\n        response = ss.parseJSON(response);\n\n        if (response === false) {\n          this._errorFinish(\n            fileObj,\n            status,\n            statusText,\n            false,\n            \"parseerror\",\n            progBox,\n            sizeBox,\n            abortBtn,\n            removeAbort\n          );\n          return;\n        }\n      }\n\n      this._opts.onComplete.call(\n        this,\n        fileObj.name,\n        response,\n        fileObj.btn,\n        fileObj.size\n      );\n      this._last(\n        sizeBox,\n        progBox,\n        pctBox,\n        abortBtn,\n        removeAbort,\n        fileObj,\n        \"success\",\n        status,\n        response\n      );\n      statusText = sizeBox = progBox = pctBox = abortBtn = removeAbort = null;\n    },\n\n    /**\n     * Verifies that file is allowed\n     * Checks file extension and file size if limits are set\n     */\n    _checkFile: function(fileObj) {\n      \"use strict\";\n\n      var extOk = false,\n        i = this._opts.allowedExtensions.length;\n\n      // Only file extension if allowedExtensions is set\n      if (i > 0) {\n        while (i--) {\n          if (\n            this._opts.allowedExtensions[i].toLowerCase() ==\n            fileObj.ext.toLowerCase()\n          ) {\n            extOk = true;\n            break;\n          }\n        }\n\n        if (!extOk) {\n          this.removeCurrent(fileObj.id);\n          this.log(\"File extension not permitted\");\n          this._opts.onExtError.call(this, fileObj.name, fileObj.ext);\n          return false;\n        }\n      }\n\n      if (\n        fileObj.size &&\n        this._opts.maxSize !== false &&\n        fileObj.size > this._opts.maxSize\n      ) {\n        this.removeCurrent(fileObj.id);\n        this.log(fileObj.name + \" exceeds \" + this._opts.maxSize + \"K limit\");\n        this._opts.onSizeError.call(\n          this,\n          fileObj.name,\n          fileObj.size,\n          fileObj.btn\n        );\n        return false;\n      }\n\n      fileObj = null;\n\n      return true;\n    },\n\n    _killInput: function() {\n      \"use strict\";\n\n      if (!this._input) {\n        return;\n      }\n\n      if (this._input.turnOff) {\n        this._input.turnOff();\n      }\n\n      if (this._input.focusOff) {\n        this._input.focusOff();\n      }\n\n      if (this._input.blurOff) {\n        this._input.blurOff();\n      }\n\n      if (this._input.parentNode.mouseOverOff) {\n        this._input.parentNode.mouseOverOff();\n      }\n\n      ss.remove(this._input.parentNode);\n      delete this._input;\n      this._input = null;\n    },\n\n    /**\n     * Enables uploader and submits next file for upload\n     */\n    _cycleQueue: function() {\n      \"use strict\";\n\n      if (this._queue.length > 0 && this._opts.autoSubmit) {\n        this.submit(undefined, true);\n      }\n    },\n\n    _validateForm: function() {\n      \"use strict\";\n\n      if (this._form.checkValidity && !this._form.checkValidity()) {\n        return false;\n      } else {\n        return true;\n      }\n    }\n  });\n\n  if (XhrOk) {\n    ss.extendObj(ss.SimpleUpload.prototype, ss.XhrUpload);\n  } else {\n    ss.extendObj(ss.SimpleUpload.prototype, ss.IframeUpload);\n  }\n\n  ss.extendObj(ss.SimpleUpload.prototype, ss.DragAndDrop);\n\n  return ss;\n});\n","function leapYear(year) {\n  return ((year % 4 === 0) && (year % 100 !== 0)) || (year % 400 === 0);\n}\n\nfunction isValidDate(inDate) {\n    var valid = true;\n\n    // reformat if supplied as mm.dd.yyyy (period delimiter)\n    if (typeof inDate === 'string') {\n      var pos = inDate.indexOf('.');\n      if ((pos > 0 && pos <= 6)) {\n        inDate = inDate.replace(/\\./g, '-');\n      }\n    }\n\n    var testDate = new Date(inDate);\n    var yr = testDate.getFullYear();\n    var mo = testDate.getMonth();\n    var day = testDate.getDate();\n\n    var daysInMonth = [31, (leapYear(yr) ? 29 : 28), 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];\n\n    if (yr < 1000) { return false; }\n    if (isNaN(mo)) { return false; }\n    if (mo + 1 > 12) { return false; }\n    if (isNaN(day)) { return false; }\n    if (day > daysInMonth[mo]) { return false; }\n\n    return valid;\n}\n\nvar rules = {\n\n  required: function(val) {\n    var str;\n\n    if (val === undefined || val === null) {\n      return false;\n    }\n\n    str = String(val).replace(/\\s/g, \"\");\n    return str.length > 0 ? true : false;\n  },\n\n  required_if: function(val, req, attribute) {\n    req = this.getParameters();\n    if (this.validator._objectPath(this.validator.input, req[0]) === req[1]) {\n      return this.validator.getRule('required').validate(val);\n    }\n\n    return true;\n  },\n\n  required_unless: function(val, req, attribute) {\n    req = this.getParameters();\n    if (this.validator._objectPath(this.validator.input, req[0]) !== req[1]) {\n      return this.validator.getRule('required').validate(val);\n    }\n\n    return true;\n  },\n\n  required_with: function(val, req, attribute) {\n    if (this.validator._objectPath(this.validator.input, req)) {\n      return this.validator.getRule('required').validate(val);\n    }\n\n    return true;\n  },\n\n  required_with_all: function(val, req, attribute) {\n\n    req = this.getParameters();\n\n    for(var i = 0; i < req.length; i++) {\n      if (!this.validator._objectPath(this.validator.input, req[i])) {\n        return true;\n      }\n    }\n\n    return this.validator.getRule('required').validate(val);\n  },\n\n  required_without: function(val, req, attribute) {\n\n    if (this.validator._objectPath(this.validator.input, req)) {\n      return true;\n    }\n\n    return this.validator.getRule('required').validate(val);\n  },\n\n  required_without_all: function(val, req, attribute) {\n\n    req = this.getParameters();\n\n    for(var i = 0; i < req.length; i++) {\n      if (this.validator._objectPath(this.validator.input, req[i])) {\n        return true;\n      }\n    }\n\n    return this.validator.getRule('required').validate(val);\n  },\n\n  'boolean': function (val) {\n    return (\n      val === true ||\n      val === false ||\n      val === 0 ||\n      val === 1 ||\n      val === '0' ||\n      val === '1' ||\n      val === 'true' ||\n      val === 'false'\n    );\n  },\n\n  // compares the size of strings\n  // with numbers, compares the value\n  size: function(val, req, attribute) {\n    if (val) {\n      req = parseFloat(req);\n\n      var size = this.getSize();\n\n      return size === req;\n    }\n\n    return true;\n  },\n\n  string: function(val, req, attribute) {\n    return typeof val === 'string';\n  },\n\n  sometimes: function(val) {\n    return true;\n  },\n\n  /**\n   * Compares the size of strings or the value of numbers if there is a truthy value\n   */\n  min: function(val, req, attribute) {\n    var size = this.getSize();\n    return size >= req;\n  },\n\n  /**\n   * Compares the size of strings or the value of numbers if there is a truthy value\n   */\n  max: function(val, req, attribute) {\n    var size = this.getSize();\n    return size <= req;\n  },\n\n  between: function(val, req, attribute) {\n    req = this.getParameters();\n    var size = this.getSize();\n    var min = parseFloat(req[0], 10);\n    var max = parseFloat(req[1], 10);\n    return size >= min && size <= max;\n  },\n\n  email: function(val) {\n    var re = /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n    return re.test(val);\n  },\n\n  numeric: function(val) {\n    var num;\n\n    num = Number(val); // tries to convert value to a number. useful if value is coming from form element\n\n    if (typeof num === 'number' && !isNaN(num) && typeof val !== 'boolean') {\n      return true;\n    } else {\n      return false;\n    }\n  },\n\n  array: function(val) {\n    return val instanceof Array;\n  },\n\n  url: function(url) {\n    return (/https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-z]{2,63}\\b([-a-zA-Z0-9@:%_\\+.~#?&//=]*)/i).test(url);\n  },\n\n  alpha: function(val) {\n    return (/^[a-zA-Z]+$/).test(val);\n  },\n\n  alpha_dash: function(val) {\n    return (/^[a-zA-Z0-9_\\-]+$/).test(val);\n  },\n\n  alpha_num: function(val) {\n    return (/^[a-zA-Z0-9]+$/).test(val);\n  },\n\n  same: function(val, req) {\n    var val1 = this.validator._flattenObject(this.validator.input)[req];\n    var val2 = val;\n\n    if (val1 === val2) {\n      return true;\n    }\n\n    return false;\n  },\n\n  different: function(val, req) {\n    var val1 = this.validator._flattenObject(this.validator.input)[req];\n    var val2 = val;\n\n    if (val1 !== val2) {\n      return true;\n    }\n\n    return false;\n  },\n\n  \"in\": function(val, req) {\n    var list, i;\n\n    if (val) {\n      list = this.getParameters();\n    }\n\n    if (val && !(val instanceof Array)) {\n      var localValue = val;\n\n      for (i = 0; i < list.length; i++) {\n        if (typeof list[i] === 'string') {\n          localValue = String(val);\n        }\n\n        if (localValue === list[i]) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n\n    if (val && val instanceof Array) {\n      for (i = 0; i < val.length; i++) {\n        if (list.indexOf(val[i]) < 0) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  },\n\n  not_in: function(val, req) {\n    var list = this.getParameters();\n    var len = list.length;\n    var returnVal = true;\n\n    for (var i = 0; i < len; i++) {\n      var localValue = val;\n\n      if (typeof list[i] === 'string') {\n        localValue = String(val);\n      }\n\n      if (localValue === list[i]) {\n        returnVal = false;\n        break;\n      }\n    }\n\n    return returnVal;\n  },\n\n  accepted: function(val) {\n    if (val === 'on' || val === 'yes' || val === 1 || val === '1' || val === true) {\n      return true;\n    }\n\n    return false;\n  },\n\n  confirmed: function(val, req, key) {\n    var confirmedKey = key + '_confirmation';\n\n    if (this.validator.input[confirmedKey] === val) {\n      return true;\n    }\n\n    return false;\n  },\n\n  integer: function(val) {\n    return String(parseInt(val, 10)) === String(val);\n  },\n\n  digits: function(val, req) {\n    var numericRule = this.validator.getRule('numeric');\n    if (numericRule.validate(val) && String(val).length === parseInt(req)) {\n      return true;\n    }\n\n    return false;\n  },\n\n  regex: function(val, req) {\n    var mod = /[g|i|m]{1,3}$/;\n    var flag = req.match(mod);\n    flag = flag ? flag[0] : \"\";\n    req = req.replace(mod, \"\").slice(1, -1);\n    req = new RegExp(req, flag);\n    return !!req.test(val);\n  },\n\n  date: function(val, format) {\n    return isValidDate(val);\n  },\n\n  present: function(val) {\n    return typeof val !== 'undefined';\n  },\n\n  after: function(val, req){\n    var val1 = this.validator.input[req];\n    var val2 = val;\n\n    if(!isValidDate(val1)){ return false;}\n    if(!isValidDate(val2)){ return false;}\n\n    if (new Date(val1).getTime() < new Date(val2).getTime()) {\n      return true;\n    }\n\n    return false;\n  },\n\n   after_or_equal: function(val, req){\n    var val1 = this.validator.input[req];\n    var val2 = val;\n\n    if(!isValidDate(val1)){ return false;}\n    if(!isValidDate(val2)){ return false;}\n\n    if (new Date(val1).getTime() <= new Date(val2).getTime()) {\n      return true;\n    }\n\n    return false;\n  },\n\n  before: function(val, req){\n    var val1 = this.validator.input[req];\n    var val2 = val;\n\n    if(!isValidDate(val1)){ return false;}\n    if(!isValidDate(val2)){ return false;}\n\n    if (new Date(val1).getTime() > new Date(val2).getTime()) {\n      return true;\n    }\n\n    return false;\n  },\n\n   before_or_equal: function(val, req){\n    var val1 = this.validator.input[req];\n    var val2 = val;\n\n    if(!isValidDate(val1)){ return false;}\n    if(!isValidDate(val2)){ return false;}\n\n    if (new Date(val1).getTime() >= new Date(val2).getTime()) {\n      return true;\n    }\n\n    return false;\n  },\n\n  hex: function(val) {\n    return (/^[0-9a-f]+$/i).test(val);\n  }\n};\n\nvar missedRuleValidator = function() {\n  throw new Error('Validator `' + this.name + '` is not defined!');\n};\nvar missedRuleMessage;\n\nfunction Rule(name, fn, async) {\n  this.name = name;\n  this.fn = fn;\n  this.passes = null;\n  this._customMessage = undefined;\n  this.async = async;\n}\n\nRule.prototype = {\n\n  /**\n   * Validate rule\n   *\n   * @param  {mixed} inputValue\n   * @param  {mixed} ruleValue\n   * @param  {string} attribute\n   * @param  {function} callback\n   * @return {boolean|undefined}\n   */\n  validate: function(inputValue, ruleValue, attribute, callback) {\n    var _this = this;\n    this._setValidatingData(attribute, inputValue, ruleValue);\n    if (typeof callback === 'function') {\n      this.callback = callback;\n      var handleResponse = function(passes, message) {\n        _this.response(passes, message);\n      };\n\n      if (this.async) {\n        return this._apply(inputValue, ruleValue, attribute, handleResponse);\n      } else {\n        return handleResponse(this._apply(inputValue, ruleValue, attribute));\n      }\n    }\n    return this._apply(inputValue, ruleValue, attribute);\n  },\n\n  /**\n   * Apply validation function\n   *\n   * @param  {mixed} inputValue\n   * @param  {mixed} ruleValue\n   * @param  {string} attribute\n   * @param  {function} callback\n   * @return {boolean|undefined}\n   */\n  _apply: function(inputValue, ruleValue, attribute, callback) {\n    var fn = this.isMissed() ? missedRuleValidator : this.fn;\n\n    return fn.apply(this, [inputValue, ruleValue, attribute, callback]);\n  },\n\n  /**\n   * Set validating data\n   *\n   * @param {string} attribute\n   * @param {mixed} inputValue\n   * @param {mixed} ruleValue\n   * @return {void}\n   */\n  _setValidatingData: function(attribute, inputValue, ruleValue) {\n    this.attribute = attribute;\n    this.inputValue = inputValue;\n    this.ruleValue = ruleValue;\n  },\n\n  /**\n   * Get parameters\n   *\n   * @return {array}\n   */\n  getParameters: function() {\n    var value = [];\n\n    if (typeof this.ruleValue === 'string') {\n      value = this.ruleValue.split(',');\n    }\n\n    if (typeof this.ruleValue === 'number') {\n      value.push(this.ruleValue);\n    }\n\n    if (this.ruleValue instanceof Array) {\n      value = this.ruleValue;\n    }\n\n    return value;\n  },\n\n  /**\n   * Get true size of value\n   *\n   * @return {integer|float}\n   */\n  getSize: function() {\n    var value = this.inputValue;\n\n    if (value instanceof Array) {\n      return value.length;\n    }\n\n    if (typeof value === 'number') {\n      return value;\n    }\n\n    if (this.validator._hasNumericRule(this.attribute)) {\n      return parseFloat(value, 10);\n    }\n\n    return value.length;\n  },\n\n  /**\n   * Get the type of value being checked; numeric or string.\n   *\n   * @return {string}\n   */\n  _getValueType: function() {\n\n    if (typeof this.inputValue === 'number' || this.validator._hasNumericRule(this.attribute)) {\n      return 'numeric';\n    }\n\n    return 'string';\n  },\n\n  /**\n   * Set the async callback response\n   *\n   * @param  {boolean|undefined} passes  Whether validation passed\n   * @param  {string|undefined} message Custom error message\n   * @return {void}\n   */\n  response: function(passes, message) {\n    this.passes = (passes === undefined || passes === true);\n    this._customMessage = message;\n    this.callback(this.passes, message);\n  },\n\n  /**\n   * Set validator instance\n   *\n   * @param {Validator} validator\n   * @return {void}\n   */\n  setValidator: function(validator) {\n    this.validator = validator;\n  },\n\n  /**\n   * Check if rule is missed\n   *\n   * @return {boolean}\n   */\n  isMissed: function() {\n    return typeof this.fn !== 'function';\n  },\n\n  get customMessage() {\n    return this.isMissed() ? missedRuleMessage : this._customMessage;\n  }\n};\n\nvar manager = {\n\n  /**\n   * List of async rule names\n   *\n   * @type {Array}\n   */\n  asyncRules: [],\n\n  /**\n   * Implicit rules (rules to always validate)\n   *\n   * @type {Array}\n   */\n  implicitRules: ['required', 'required_if', 'required_unless', 'required_with', 'required_with_all', 'required_without', 'required_without_all', 'accepted', 'present'],\n\n  /**\n   * Get rule by name\n   *\n   * @param  {string} name\n   * @param {Validator}\n   * @return {Rule}\n   */\n  make: function(name, validator) {\n    var async = this.isAsync(name);\n    var rule = new Rule(name, rules[name], async);\n    rule.setValidator(validator);\n    return rule;\n  },\n\n  /**\n   * Determine if given rule is async\n   *\n   * @param  {string}  name\n   * @return {boolean}\n   */\n  isAsync: function(name) {\n    for (var i = 0, len = this.asyncRules.length; i < len; i++) {\n      if (this.asyncRules[i] === name) {\n        return true;\n      }\n    }\n    return false;\n  },\n\n  /**\n   * Determine if rule is implicit (should always validate)\n   *\n   * @param {string} name\n   * @return {boolean}\n   */\n  isImplicit: function(name) {\n    return this.implicitRules.indexOf(name) > -1;\n  },\n\n  /**\n   * Register new rule\n   *\n   * @param  {string}   name\n   * @param  {function} fn\n   * @return {void}\n   */\n  register: function(name, fn) {\n    rules[name] = fn;\n  },\n\n    /**\n   * Register new implicit rule\n   *\n   * @param  {string}   name\n   * @param  {function} fn\n   * @return {void}\n   */\n  registerImplicit: function(name, fn) {\n    this.register(name, fn);\n    this.implicitRules.push(name);\n  },\n\n  /**\n   * Register async rule\n   *\n   * @param  {string}   name\n   * @param  {function} fn\n   * @return {void}\n   */\n  registerAsync: function(name, fn) {\n    this.register(name, fn);\n    this.asyncRules.push(name);\n  },\n\n  /**\n   * Register implicit async rule\n   *\n   * @param  {string}   name\n   * @param  {function} fn\n   * @return {void}\n   */\n  registerAsyncImplicit: function(name, fn) {\n    this.registerImplicit(name, fn);\n    this.asyncRules.push(name);\n  },\n\n  registerMissedRuleValidator: function(fn, message) {\n    missedRuleValidator = fn;\n    missedRuleMessage = message;\n  }\n};\n\n\n\nmodule.exports = manager;\n","var replacements = {\n\n  /**\n   * Between replacement (replaces :min and :max)\n   *\n   * @param  {string} template\n   * @param  {Rule} rule\n   * @return {string}\n   */\n  between: function(template, rule) {\n    var parameters = rule.getParameters();\n    return this._replacePlaceholders(rule, template, {\n      min: parameters[0],\n      max: parameters[1]\n    });\n  },\n\n  /**\n   * Required_if replacement.\n   *\n   * @param  {string} template\n   * @param  {Rule} rule\n   * @return {string}\n   */\n  required_if: function(template, rule) {\n    var parameters = rule.getParameters();\n    return this._replacePlaceholders(rule, template, {\n      other: this._getAttributeName(parameters[0]),\n      value: parameters[1]\n    });\n  },\n\n  /**\n   * Required_unless replacement.\n   *\n   * @param  {string} template\n   * @param  {Rule} rule\n   * @return {string}\n   */\n  required_unless: function(template, rule) {\n    var parameters = rule.getParameters();\n    return this._replacePlaceholders(rule, template, {\n      other: this._getAttributeName(parameters[0]),\n      value: parameters[1]\n    });\n  },\n\n  /**\n   * Required_with replacement.\n   *\n   * @param  {string} template\n   * @param  {Rule} rule\n   * @return {string}\n   */\n  required_with: function(template, rule) {\n    var parameters = rule.getParameters();\n    return this._replacePlaceholders(rule, template, {\n      field: this._getAttributeName(parameters[0])\n    });\n  },\n\n  /**\n   * Required_with_all replacement.\n   *\n   * @param  {string} template\n   * @param  {Rule} rule\n   * @return {string}\n   */\n  required_with_all: function(template, rule) {\n    var parameters = rule.getParameters();\n    var getAttributeName = this._getAttributeName.bind(this);\n    return this._replacePlaceholders(rule, template, {\n      fields: parameters.map(getAttributeName).join(', ')\n    });\n  },\n\n  /**\n   * Required_without replacement.\n   *\n   * @param  {string} template\n   * @param  {Rule} rule\n   * @return {string}\n   */\n  required_without: function(template, rule) {\n    var parameters = rule.getParameters();\n    return this._replacePlaceholders(rule, template, {\n      field: this._getAttributeName(parameters[0])\n    });\n  },\n\n  /**\n   * Required_without_all replacement.\n   *\n   * @param  {string} template\n   * @param  {Rule} rule\n   * @return {string}\n   */\n  required_without_all: function(template, rule) {\n    var parameters = rule.getParameters();\n    var getAttributeName = this._getAttributeName.bind(this);\n    return this._replacePlaceholders(rule, template, {\n      fields: parameters.map(getAttributeName).join(', ')\n    });\n  },\n\n /**\n   * After replacement.\n   *\n   * @param  {string} template\n   * @param  {Rule} rule\n   * @return {string}\n   */\n  after: function(template, rule) {\n    var parameters = rule.getParameters();\n    return this._replacePlaceholders(rule, template, {\n      after: this._getAttributeName(parameters[0])\n    });\n  },\n\n  /**\n   * Before replacement.\n   *\n   * @param  {string} template\n   * @param  {Rule} rule\n   * @return {string}\n   */\n  before: function(template, rule) {\n    var parameters = rule.getParameters();\n    return this._replacePlaceholders(rule, template, {\n      before: this._getAttributeName(parameters[0])\n    });\n  },\n\n  /**\n   * After_or_equal replacement.\n   *\n   * @param  {string} template\n   * @param  {Rule} rule\n   * @return {string}\n   */\n  after_or_equal: function(template, rule) {\n    var parameters = rule.getParameters();\n    return this._replacePlaceholders(rule, template, {\n      after_or_equal: this._getAttributeName(parameters[0])\n    });\n  },\n\n  /**\n   * Before_or_equal replacement.\n   *\n   * @param  {string} template\n   * @param  {Rule} rule\n   * @return {string}\n   */\n  before_or_equal: function(template, rule) {\n    var parameters = rule.getParameters();\n    return this._replacePlaceholders(rule, template, {\n      before_or_equal: this._getAttributeName(parameters[0])\n    });\n  },\n\n  /**\n   * Same replacement.\n   *\n   * @param  {string} template\n   * @param  {Rule} rule\n   * @return {string}\n   */\n  same: function(template, rule) {\n    var parameters = rule.getParameters();\n    return this._replacePlaceholders(rule, template, {\n      same: this._getAttributeName(parameters[0])\n    });\n  },\n};\n\nfunction formatter(attribute) {\n  return attribute.replace(/[_\\[]/g, ' ').replace(/]/g, '');\n}\n\nmodule.exports = {\n  replacements: replacements,\n  formatter: formatter\n};\n","var Attributes = require('./attributes');\n\nvar Messages = function(lang, messages) {\n  this.lang = lang;\n  this.messages = messages;\n  this.customMessages = {};\n  this.attributeNames = {};\n};\n\nMessages.prototype = {\n  constructor: Messages,\n\n  /**\n   * Set custom messages\n   *\n   * @param {object} customMessages\n   * @return {void}\n   */\n  _setCustom: function(customMessages) {\n    this.customMessages = customMessages || {};\n  },\n\n  /**\n   * Set custom attribute names.\n   *\n   * @param {object} attributes\n   */\n  _setAttributeNames: function(attributes) {\n    this.attributeNames = attributes;\n  },\n\n  /**\n   * Set the attribute formatter.\n   *\n   * @param {fuction} func\n   * @return {void}\n   */\n  _setAttributeFormatter: function(func) {\n    this.attributeFormatter = func;\n  },\n\n  /**\n   * Get attribute name to display.\n   *\n   * @param  {string} attribute\n   * @return {string}\n   */\n  _getAttributeName: function(attribute) {\n    var name = attribute;\n    if (this.attributeNames.hasOwnProperty(attribute)) {\n      return this.attributeNames[attribute];\n    } else if (this.messages.attributes.hasOwnProperty(attribute)) {\n      name = this.messages.attributes[attribute];\n    }\n\n    if (this.attributeFormatter) {\n      name = this.attributeFormatter(name);\n    }\n\n    return name;\n  },\n\n  /**\n   * Get all messages\n   *\n   * @return {object}\n   */\n  all: function() {\n    return this.messages;\n  },\n\n  /**\n   * Render message\n   *\n   * @param  {Rule} rule\n   * @return {string}\n   */\n  render: function(rule) {\n    if (rule.customMessage) {\n      return rule.customMessage;\n    }\n    var template = this._getTemplate(rule);\n\n    var message;\n    if (Attributes.replacements[rule.name]) {\n      message = Attributes.replacements[rule.name].apply(this, [template, rule]);\n    } else {\n      message = this._replacePlaceholders(rule, template, {});\n    }\n\n    return message;\n  },\n\n  /**\n   * Get the template to use for given rule\n   *\n   * @param  {Rule} rule\n   * @return {string}\n   */\n  _getTemplate: function(rule) {\n\n    var messages = this.messages;\n    var template = messages.def;\n    var customMessages = this.customMessages;\n    var formats = [rule.name + '.' + rule.attribute, rule.name];\n\n    for (var i = 0, format; i < formats.length; i++) {\n      format = formats[i];\n      if (customMessages.hasOwnProperty(format)) {\n        template = customMessages[format];\n        break;\n      } else if (messages.hasOwnProperty(format)) {\n        template = messages[format];\n        break;\n      }\n    }\n\n    if (typeof template === 'object') {\n      template = template[rule._getValueType()];\n    }\n\n    return template;\n  },\n\n  /**\n   * Replace placeholders in the template using the data object\n   *\n   * @param  {Rule} rule\n   * @param  {string} template\n   * @param  {object} data\n   * @return {string}\n   */\n  _replacePlaceholders: function(rule, template, data) {\n    var message, attribute;\n\n    data.attribute = this._getAttributeName(rule.attribute);\n    data[rule.name] = data[rule.name] || rule.getParameters().join(',');\n\n    if (typeof template === 'string' && typeof data === 'object') {\n      message = template;\n\n      for (attribute in data) {\n        message = message.replace(new RegExp(':' + attribute, 'g'), data[attribute]);\n      }\n    }\n\n    return message;\n  }\n\n};\n\nmodule.exports = Messages;\n","module.exports = {\n  accepted: 'The :attribute must be accepted.',\n  after: 'The :attribute must be after :after.',\n  after_or_equal: 'The :attribute must be equal or after :after_or_equal.',\n  alpha: 'The :attribute field must contain only alphabetic characters.',\n  alpha_dash: 'The :attribute field may only contain alpha-numeric characters, as well as dashes and underscores.',\n  alpha_num: 'The :attribute field must be alphanumeric.',\n  before: 'The :attribute must be before :before.',\n  before_or_equal: 'The :attribute must be equal or before :before_or_equal.',\n  between: 'The :attribute field must be between :min and :max.',\n  confirmed: 'The :attribute confirmation does not match.',\n  email: 'The :attribute format is invalid.',\n  date: 'The :attribute is not a valid date format.',\n  def: 'The :attribute attribute has errors.',\n  digits: 'The :attribute must be :digits digits.',\n  different: 'The :attribute and :different must be different.',\n  'in': 'The selected :attribute is invalid.',\n  integer: 'The :attribute must be an integer.',\n  hex: 'The :attribute field should have hexadecimal format',\n  min: {\n    numeric: 'The :attribute must be at least :min.',\n    string: 'The :attribute must be at least :min characters.'\n  },\n  max: {\n    numeric: 'The :attribute may not be greater than :max.',\n    string: 'The :attribute may not be greater than :max characters.'\n  },\n  not_in: 'The selected :attribute is invalid.',\n  numeric: 'The :attribute must be a number.',\n  present: 'The :attribute field must be present (but can be empty).',\n  required: 'The :attribute field is required.',\n  required_if: 'The :attribute field is required when :other is :value.',\n  required_unless: 'The :attribute field is required when :other is not :value.',\n  required_with: 'The :attribute field is required when :field is not empty.',\n  required_with_all: 'The :attribute field is required when :fields are not empty.',\n  required_without: 'The :attribute field is required when :field is empty.',\n  required_without_all: 'The :attribute field is required when :fields are empty.',\n  same: 'The :attribute and :same fields must match.',\n  size: {\n    numeric: 'The :attribute must be :size.',\n    string: 'The :attribute must be :size characters.'\n  },\n  string: 'The :attribute must be a string.',\n  url: 'The :attribute format is invalid.',\n  regex: 'The :attribute format is invalid.',\n  attributes: {}\n};\n","var Messages = require('./messages');\n\nrequire('./lang/en');\n\nvar require_method = require;\n\nvar container = {\n\n  messages: {},\n\n  /**\n   * Set messages for language\n   *\n   * @param {string} lang\n   * @param {object} rawMessages\n   * @return {void}\n   */\n  _set: function(lang, rawMessages) {\n    this.messages[lang] = rawMessages;\n  },\n\n  /**\n   * Set message for given language's rule.\n   *\n   * @param {string} lang\n   * @param {string} attribute\n   * @param {string|object} message\n   * @return {void}\n   */\n  _setRuleMessage: function(lang, attribute, message) {\n    this._load(lang);\n    if (message === undefined) {\n      message = this.messages[lang].def;\n    }\n\n    this.messages[lang][attribute] = message;\n  },\n\n  /**\n   * Load messages (if not already loaded)\n   *\n   * @param  {string} lang\n   * @return {void}\n   */\n  _load: function(lang) {\n    if (!this.messages[lang]) {\n      try {\n        var rawMessages = require_method('./lang/' + lang);\n        this._set(lang, rawMessages);\n      } catch (e) {}\n    }\n  },\n\n  /**\n   * Get raw messages for language\n   *\n   * @param  {string} lang\n   * @return {object}\n   */\n  _get: function(lang) {\n    this._load(lang);\n    return this.messages[lang];\n  },\n\n  /**\n   * Make messages for given language\n   *\n   * @param  {string} lang\n   * @return {Messages}\n   */\n  _make: function(lang) {\n    this._load(lang);\n    return new Messages(lang, this.messages[lang]);\n  }\n\n};\n\nmodule.exports = container;\n","var Errors = function() {\n  this.errors = {};\n};\n\nErrors.prototype = {\n  constructor: Errors,\n\n  /**\n   * Add new error message for given attribute\n   *\n   * @param  {string} attribute\n   * @param  {string} message\n   * @return {void}\n   */\n  add: function(attribute, message) {\n    if (!this.has(attribute)) {\n      this.errors[attribute] = [];\n    }\n\n    if (this.errors[attribute].indexOf(message) === -1) {\n      this.errors[attribute].push(message);\n    }\n  },\n\n  /**\n   * Returns an array of error messages for an attribute, or an empty array\n   *\n   * @param  {string} attribute A key in the data object being validated\n   * @return {array} An array of error messages\n   */\n  get: function(attribute) {\n    if (this.has(attribute)) {\n      return this.errors[attribute];\n    }\n\n    return [];\n  },\n\n  /**\n   * Returns the first error message for an attribute, false otherwise\n   *\n   * @param  {string} attribute A key in the data object being validated\n   * @return {string|false} First error message or false\n   */\n  first: function(attribute) {\n    if (this.has(attribute)) {\n      return this.errors[attribute][0];\n    }\n\n    return false;\n  },\n\n  /**\n   * Get all error messages from all failing attributes\n   *\n   * @return {Object} Failed attribute names for keys and an array of messages for values\n   */\n  all: function() {\n    return this.errors;\n  },\n\n  /**\n   * Determine if there are any error messages for an attribute\n   *\n   * @param  {string}  attribute A key in the data object being validated\n   * @return {boolean}\n   */\n  has: function(attribute) {\n    if (this.errors.hasOwnProperty(attribute)) {\n      return true;\n    }\n\n    return false;\n  }\n};\n\nmodule.exports = Errors;\n","function AsyncResolvers(onFailedOne, onResolvedAll) {\n  this.onResolvedAll = onResolvedAll;\n  this.onFailedOne = onFailedOne;\n  this.resolvers = {};\n  this.resolversCount = 0;\n  this.passed = [];\n  this.failed = [];\n  this.firing = false;\n}\n\nAsyncResolvers.prototype = {\n\n  /**\n   * Add resolver\n   *\n   * @param {Rule} rule\n   * @return {integer}\n   */\n  add: function(rule) {\n    var index = this.resolversCount;\n    this.resolvers[index] = rule;\n    this.resolversCount++;\n    return index;\n  },\n\n  /**\n   * Resolve given index\n   *\n   * @param  {integer} index\n   * @return {void}\n   */\n  resolve: function(index) {\n    var rule = this.resolvers[index];\n    if (rule.passes === true) {\n      this.passed.push(rule);\n    } else if (rule.passes === false) {\n      this.failed.push(rule);\n      this.onFailedOne(rule);\n    }\n\n    this.fire();\n  },\n\n  /**\n   * Determine if all have been resolved\n   *\n   * @return {boolean}\n   */\n  isAllResolved: function() {\n    return (this.passed.length + this.failed.length) === this.resolversCount;\n  },\n\n  /**\n   * Attempt to fire final all resolved callback if completed\n   *\n   * @return {void}\n   */\n  fire: function() {\n\n    if (!this.firing) {\n      return;\n    }\n\n    if (this.isAllResolved()) {\n      this.onResolvedAll(this.failed.length === 0);\n    }\n\n  },\n\n  /**\n   * Enable firing\n   *\n   * @return {void}\n   */\n  enableFiring: function() {\n    this.firing = true;\n  }\n\n};\n\nmodule.exports = AsyncResolvers;\n","var Rules = require('./rules');\nvar Lang = require('./lang');\nvar Errors = require('./errors');\nvar Attributes = require('./attributes');\nvar AsyncResolvers = require('./async');\n\nvar Validator = function (input, rules, customMessages) {\n  var lang = Validator.getDefaultLang();\n  this.input = input || {};\n\n  this.messages = Lang._make(lang);\n  this.messages._setCustom(customMessages);\n  this.setAttributeFormatter(Validator.prototype.attributeFormatter);\n\n  this.errors = new Errors();\n  this.errorCount = 0;\n\n  this.hasAsync = false;\n  this.rules = this._parseRules(rules);\n};\n\nValidator.prototype = {\n\n  constructor: Validator,\n\n  /**\n   * Default language\n   *\n   * @type {string}\n   */\n  lang: 'en',\n\n  /**\n   * Numeric based rules\n   *\n   * @type {array}\n   */\n  numericRules: ['integer', 'numeric'],\n\n  /**\n   * Attribute formatter.\n   *\n   * @type {function}\n   */\n  attributeFormatter: Attributes.formatter,\n\n  /**\n   * Run validator\n   *\n   * @return {boolean} Whether it passes; true = passes, false = fails\n   */\n  check: function () {\n    var self = this;\n\n    for (var attribute in this.rules) {\n      var attributeRules = this.rules[attribute];\n      var inputValue = this._objectPath(this.input, attribute);\n\n      if (this._hasRule(attribute, ['sometimes']) && !this._suppliedWithData(attribute)) {\n        continue;\n      }\n\n      for (var i = 0, len = attributeRules.length, rule, ruleOptions, rulePassed; i < len; i++) {\n        ruleOptions = attributeRules[i];\n        rule = this.getRule(ruleOptions.name);\n\n        if (!this._isValidatable(rule, inputValue)) {\n          continue;\n        }\n\n        rulePassed = rule.validate(inputValue, ruleOptions.value, attribute);\n        if (!rulePassed) {\n          this._addFailure(rule);\n        }\n\n        if (this._shouldStopValidating(attribute, rulePassed)) {\n          break;\n        }\n      }\n    }\n\n    return this.errorCount === 0;\n  },\n\n  /**\n   * Run async validator\n   *\n   * @param {function} passes\n   * @param {function} fails\n   * @return {void}\n   */\n  checkAsync: function (passes, fails) {\n    var _this = this;\n    passes = passes || function () {};\n    fails = fails || function () {};\n\n    var failsOne = function (rule, message) {\n      _this._addFailure(rule, message);\n    };\n\n    var resolvedAll = function (allPassed) {\n      if (allPassed) {\n        passes();\n      } else {\n        fails();\n      }\n    };\n\n    var asyncResolvers = new AsyncResolvers(failsOne, resolvedAll);\n\n    var validateRule = function (inputValue, ruleOptions, attribute, rule) {\n      return function () {\n        var resolverIndex = asyncResolvers.add(rule);\n        rule.validate(inputValue, ruleOptions.value, attribute, function () {\n          asyncResolvers.resolve(resolverIndex);\n        });\n      };\n    };\n\n    for (var attribute in this.rules) {\n      var attributeRules = this.rules[attribute];\n      var inputValue = this._objectPath(this.input, attribute);\n\n      if (this._hasRule(attribute, ['sometimes']) && !this._suppliedWithData(attribute)) {\n        continue;\n      }\n\n      for (var i = 0, len = attributeRules.length, rule, ruleOptions; i < len; i++) {\n        ruleOptions = attributeRules[i];\n\n        rule = this.getRule(ruleOptions.name);\n\n        if (!this._isValidatable(rule, inputValue)) {\n          continue;\n        }\n\n        validateRule(inputValue, ruleOptions, attribute, rule)();\n      }\n    }\n\n    asyncResolvers.enableFiring();\n    asyncResolvers.fire();\n  },\n\n  /**\n   * Add failure and error message for given rule\n   *\n   * @param {Rule} rule\n   */\n  _addFailure: function (rule) {\n    var msg = this.messages.render(rule);\n    this.errors.add(rule.attribute, msg);\n    this.errorCount++;\n  },\n\n  /**\n   * Flatten nested object, normalizing { foo: { bar: 1 } } into: { 'foo.bar': 1 }\n   *\n   * @param  {object} nested object\n   * @return {object} flattened object\n   */\n  _flattenObject: function (obj) {\n    var flattened = {};\n\n    function recurse(current, property) {\n      if (!property && Object.getOwnPropertyNames(current).length === 0) {\n        return;\n      }\n      if (Object(current) !== current || Array.isArray(current)) {\n        flattened[property] = current;\n      } else {\n        var isEmpty = true;\n        for (var p in current) {\n          isEmpty = false;\n          recurse(current[p], property ? property + \".\" + p : p);\n        }\n        if (isEmpty) {\n          flattened[property] = {};\n        }\n      }\n    }\n    if (obj) {\n      recurse(obj);\n    }\n    return flattened;\n  },\n\n  /**\n   * Extract value from nested object using string path with dot notation\n   *\n   * @param  {object} object to search in\n   * @param  {string} path inside object\n   * @return {any|void} value under the path\n   */\n  _objectPath: function (obj, path) {\n    if (Object.prototype.hasOwnProperty.call(obj, path)) {\n      return obj[path];\n    }\n\n    var keys = path.replace(/\\[(\\w+)\\]/g, \".$1\").replace(/^\\./, \"\").split(\".\");\n    var copy = {};\n    for (var attr in obj) {\n      if (Object.prototype.hasOwnProperty.call(obj, attr)) {\n        copy[attr] = obj[attr];\n      }\n    }\n\n    for (var i = 0, l = keys.length; i < l; i++) {\n      if (Object.hasOwnProperty.call(copy, keys[i])) {\n        copy = copy[keys[i]];\n      } else {\n        return;\n      }\n    }\n    return copy;\n  },\n\n  /**\n   * Parse rules, normalizing format into: { attribute: [{ name: 'age', value: 3 }] }\n   *\n   * @param  {object} rules\n   * @return {object}\n   */\n  _parseRules: function (rules) {\n\n    var parsedRules = {};\n    rules = this._flattenObject(rules);\n\n    for (var attribute in rules) {\n\n      var rulesArray = rules[attribute];\n\n      this._parseRulesCheck(attribute, rulesArray, parsedRules);\n    }\n    return parsedRules;\n\n\n  },\n\n  _parseRulesCheck: function (attribute, rulesArray, parsedRules, wildCardValues) {\n    if (attribute.indexOf('*') > -1) {\n      this._parsedRulesRecurse(attribute, rulesArray, parsedRules, wildCardValues);\n    } else {\n      this._parseRulesDefault(attribute, rulesArray, parsedRules, wildCardValues);\n    }\n  },\n\n  _parsedRulesRecurse: function (attribute, rulesArray, parsedRules, wildCardValues) {\n    var parentPath = attribute.substr(0, attribute.indexOf('*') - 1);\n    var propertyValue = this._objectPath(this.input, parentPath);\n\n    if (propertyValue) {\n      for (var propertyNumber = 0; propertyNumber < propertyValue.length; propertyNumber++) {\n        var workingValues = wildCardValues ? wildCardValues.slice() : [];\n        workingValues.push(propertyNumber);\n        this._parseRulesCheck(attribute.replace('*', propertyNumber), rulesArray, parsedRules, workingValues);\n      }\n    }\n  },\n\n  _parseRulesDefault: function (attribute, rulesArray, parsedRules, wildCardValues) {\n    var attributeRules = [];\n\n    if (rulesArray instanceof Array) {\n      rulesArray = this._prepareRulesArray(rulesArray);\n    }\n\n    if (typeof rulesArray === 'string') {\n      rulesArray = rulesArray.split('|');\n    }\n\n    for (var i = 0, len = rulesArray.length, rule; i < len; i++) {\n      rule = typeof rulesArray[i] === 'string' ? this._extractRuleAndRuleValue(rulesArray[i]) : rulesArray[i];\n      if (rule.value) {\n        rule.value = this._replaceWildCards(rule.value, wildCardValues);\n        this._replaceWildCardsMessages(wildCardValues);\n      }\n\n      if (Rules.isAsync(rule.name)) {\n        this.hasAsync = true;\n      }\n      attributeRules.push(rule);\n    }\n\n    parsedRules[attribute] = attributeRules;\n  },\n\n  _replaceWildCards: function (path, nums) {\n\n    if (!nums) {\n      return path;\n    }\n\n    var path2 = path;\n    nums.forEach(function (value) {\n      if(Array.isArray(path2)){\n        path2 = path2[0];\n      }\n      pos = path2.indexOf('*');\n      if (pos === -1) {\n        return path2;\n      }\n      path2 = path2.substr(0, pos) + value + path2.substr(pos + 1);\n    });\n    if(Array.isArray(path)){\n      path[0] = path2;\n      path2 = path;\n    }\n    return path2;\n  },\n\n  _replaceWildCardsMessages: function (nums) {\n    var customMessages = this.messages.customMessages;\n    var self = this;\n    Object.keys(customMessages).forEach(function (key) {\n      if (nums) {\n        var newKey = self._replaceWildCards(key, nums);\n        customMessages[newKey] = customMessages[key];\n      }\n    });\n\n    this.messages._setCustom(customMessages);\n  },\n  /**\n   * Prepare rules if it comes in Array. Check for objects. Need for type validation.\n   *\n   * @param  {array} rulesArray\n   * @return {array}\n   */\n  _prepareRulesArray: function (rulesArray) {\n    var rules = [];\n\n    for (var i = 0, len = rulesArray.length; i < len; i++) {\n      if (typeof rulesArray[i] === 'object') {\n        for (var rule in rulesArray[i]) {\n          rules.push({\n            name: rule,\n            value: rulesArray[i][rule]\n          });\n        }\n      } else {\n        rules.push(rulesArray[i]);\n      }\n    }\n\n    return rules;\n  },\n\n  /**\n   * Determines if the attribute is supplied with the original data object.\n   *\n   * @param  {array} attribute\n   * @return {boolean}\n   */\n  _suppliedWithData: function (attribute) {\n    return this.input.hasOwnProperty(attribute);\n  },\n\n  /**\n   * Extract a rule and a value from a ruleString (i.e. min:3), rule = min, value = 3\n   *\n   * @param  {string} ruleString min:3\n   * @return {object} object containing the name of the rule and value\n   */\n  _extractRuleAndRuleValue: function (ruleString) {\n    var rule = {},\n      ruleArray;\n\n    rule.name = ruleString;\n\n    if (ruleString.indexOf(':') >= 0) {\n      ruleArray = ruleString.split(':');\n      rule.name = ruleArray[0];\n      rule.value = ruleArray.slice(1).join(\":\");\n    }\n\n    return rule;\n  },\n\n  /**\n   * Determine if attribute has any of the given rules\n   *\n   * @param  {string}  attribute\n   * @param  {array}   findRules\n   * @return {boolean}\n   */\n  _hasRule: function (attribute, findRules) {\n    var rules = this.rules[attribute] || [];\n    for (var i = 0, len = rules.length; i < len; i++) {\n      if (findRules.indexOf(rules[i].name) > -1) {\n        return true;\n      }\n    }\n    return false;\n  },\n\n  /**\n   * Determine if attribute has any numeric-based rules.\n   *\n   * @param  {string}  attribute\n   * @return {Boolean}\n   */\n  _hasNumericRule: function (attribute) {\n    return this._hasRule(attribute, this.numericRules);\n  },\n\n  /**\n   * Determine if rule is validatable\n   *\n   * @param  {Rule}   rule\n   * @param  {mixed}  value\n   * @return {boolean}\n   */\n  _isValidatable: function (rule, value) {\n    if (Rules.isImplicit(rule.name)) {\n      return true;\n    }\n\n    return this.getRule('required').validate(value);\n  },\n\n  /**\n   * Determine if we should stop validating.\n   *\n   * @param  {string} attribute\n   * @param  {boolean} rulePassed\n   * @return {boolean}\n   */\n  _shouldStopValidating: function (attribute, rulePassed) {\n\n    var stopOnAttributes = this.stopOnAttributes;\n    if (typeof stopOnAttributes === 'undefined' || stopOnAttributes === false || rulePassed === true) {\n      return false;\n    }\n\n    if (stopOnAttributes instanceof Array) {\n      return stopOnAttributes.indexOf(attribute) > -1;\n    }\n\n    return true;\n  },\n\n  /**\n   * Set custom attribute names.\n   *\n   * @param {object} attributes\n   * @return {void}\n   */\n  setAttributeNames: function (attributes) {\n    this.messages._setAttributeNames(attributes);\n  },\n\n  /**\n   * Set the attribute formatter.\n   *\n   * @param {fuction} func\n   * @return {void}\n   */\n  setAttributeFormatter: function (func) {\n    this.messages._setAttributeFormatter(func);\n  },\n\n  /**\n   * Get validation rule\n   *\n   * @param  {string} name\n   * @return {Rule}\n   */\n  getRule: function (name) {\n    return Rules.make(name, this);\n  },\n\n  /**\n   * Stop on first error.\n   *\n   * @param  {boolean|array} An array of attributes or boolean true/false for all attributes.\n   * @return {void}\n   */\n  stopOnError: function (attributes) {\n    this.stopOnAttributes = attributes;\n  },\n\n  /**\n   * Determine if validation passes\n   *\n   * @param {function} passes\n   * @return {boolean|undefined}\n   */\n  passes: function (passes) {\n    var async = this._checkAsync('passes', passes);\n    if (async) {\n      return this.checkAsync(passes);\n    }\n    return this.check();\n  },\n\n  /**\n   * Determine if validation fails\n   *\n   * @param {function} fails\n   * @return {boolean|undefined}\n   */\n  fails: function (fails) {\n    var async = this._checkAsync('fails', fails);\n    if (async) {\n      return this.checkAsync(function () {}, fails);\n    }\n    return !this.check();\n  },\n\n  /**\n   * Check if validation should be called asynchronously\n   *\n   * @param  {string}   funcName Name of the caller\n   * @param  {function} callback\n   * @return {boolean}\n   */\n  _checkAsync: function (funcName, callback) {\n    var hasCallback = typeof callback === 'function';\n    if (this.hasAsync && !hasCallback) {\n      throw funcName + ' expects a callback when async rules are being tested.';\n    }\n\n    return this.hasAsync || hasCallback;\n  }\n\n};\n\n/**\n * Set messages for language\n *\n * @param {string} lang\n * @param {object} messages\n * @return {this}\n */\nValidator.setMessages = function (lang, messages) {\n  Lang._set(lang, messages);\n  return this;\n};\n\n/**\n * Get messages for given language\n *\n * @param  {string} lang\n * @return {Messages}\n */\nValidator.getMessages = function (lang) {\n  return Lang._get(lang);\n};\n\n/**\n * Set default language to use\n *\n * @param {string} lang\n * @return {void}\n */\nValidator.useLang = function (lang) {\n  this.prototype.lang = lang;\n};\n\n/**\n * Get default language\n *\n * @return {string}\n */\nValidator.getDefaultLang = function () {\n  return this.prototype.lang;\n};\n\n/**\n * Set the attribute formatter.\n *\n * @param {fuction} func\n * @return {void}\n */\nValidator.setAttributeFormatter = function (func) {\n  this.prototype.attributeFormatter = func;\n};\n\n/**\n * Stop on first error.\n *\n * @param  {boolean|array} An array of attributes or boolean true/false for all attributes.\n * @return {void}\n */\nValidator.stopOnError = function (attributes) {\n  this.prototype.stopOnAttributes = attributes;\n};\n\n/**\n * Register custom validation rule\n *\n * @param  {string}   name\n * @param  {function} fn\n * @param  {string}   message\n * @return {void}\n */\nValidator.register = function (name, fn, message) {\n  var lang = Validator.getDefaultLang();\n  Rules.register(name, fn);\n  Lang._setRuleMessage(lang, name, message);\n};\n\n/**\n * Register custom validation rule\n *\n * @param  {string}   name\n * @param  {function} fn\n * @param  {string}   message\n * @return {void}\n */\nValidator.registerImplicit = function (name, fn, message) {\n  var lang = Validator.getDefaultLang();\n  Rules.registerImplicit(name, fn);\n  Lang._setRuleMessage(lang, name, message);\n};\n\n/**\n * Register asynchronous validation rule\n *\n * @param  {string}   name\n * @param  {function} fn\n * @param  {string}   message\n * @return {void}\n */\nValidator.registerAsync = function (name, fn, message) {\n  var lang = Validator.getDefaultLang();\n  Rules.registerAsync(name, fn);\n  Lang._setRuleMessage(lang, name, message);\n};\n\n/**\n * Register asynchronous validation rule\n *\n * @param  {string}   name\n * @param  {function} fn\n * @param  {string}   message\n * @return {void}\n */\nValidator.registerAsyncImplicit = function (name, fn, message) {\n  var lang = Validator.getDefaultLang();\n  Rules.registerAsyncImplicit(name, fn);\n  Lang._setRuleMessage(lang, name, message);\n};\n\n/**\n * Register validator for missed validation rule\n *\n * @param  {string}   name\n * @param  {function} fn\n * @param  {string}   message\n * @return {void}\n */\nValidator.registerMissedRuleValidator = function(fn, message) {\n  Rules.registerMissedRuleValidator(fn, message);\n};\n\nmodule.exports = Validator;\n","import SAU from \"../vendor/simple-ajax-uploader\";\nimport { getFormElements, checkForms, injectStyleSheet } from \"./utils/styling\";\nimport { checkVersion, USER_ID } from \"./utils/squarespace\";\nimport validatorjs from \"validatorjs\";\nimport get from \"lodash/get\";\n\nconst UPLOAD_URL = `${process.env.API_BASE_URL}/v2/upload`;\n\nclass FormUploader {\n  constructor(fileInput) {\n    injectStyleSheet();\n\n    this.hasShownError = false;\n    this.requirements = {\n      field: \"Label name\",\n      message: \"Please enter your label name before uploading your collection.\"\n    };\n    this.fileInput = fileInput;\n\n    this.buildUploader = this.buildUploader.bind(this);\n    this.handleValidation = this.handleValidation.bind(this);\n    this.resetErrorStyles = this.resetErrorStyles.bind(this);\n\n    this.currentUploader = this.buildUploader(fileInput);\n    this.folderName = \"\";\n    this.pagePath = (process.env.NODE_ENV === \"test\"\n      ? \"/my-upload-page\"\n      : get(window, \"top.location.pathname\")\n    ).replace(/^\\//, \"\");\n    this.folderBaseName = `${USER_ID}/${this.pagePath}`;\n\n    // checkVersion();\n    console.log(\"CONSTRUCTOR\");\n  }\n\n  resetErrorStyles({ inputNode, parentNode, hasAddedParentClass }) {\n    const currentClasses = inputNode.className;\n    inputNode.className = currentClasses.replace(\" field-validation-error\", \"\");\n    if (hasAddedParentClass) {\n      const currentParentClasses = parentNode.className;\n      parentNode.className = currentParentClasses.replace(\n        \" field-validation-error-message\",\n        \"\"\n      );\n    }\n  }\n\n  handleValidation(event) {\n    const { requirements } = this;\n\n    const labels = Array.prototype.slice.call(\n      document.querySelectorAll(\"form label\")\n    );\n\n    const data = {};\n    const rules = {};\n    const fields = {};\n\n    console.warn(\"REQUIREMENTS: \", requirements);\n\n    labels.forEach(label => {\n      const currentLabelText = label.innerHTML\n        .replace(/\\<.*\\>/, \"\")\n        .trim()\n        .toLowerCase();\n\n      console.warn(\"LABEL: \", label, currentLabelText);\n      if (currentLabelText === requirements.field.toLowerCase()) {\n        const currentFor = label.getAttribute(\"for\");\n        const inputId = `#${currentFor}`;\n        const input = !!currentFor && document.querySelector(inputId);\n        const validationKey = currentLabelText.replace(/\\s/g, \"_\");\n\n        if (!!input) {\n          data[validationKey] = input.value;\n          this.folderName = input.value;\n          rules[validationKey] = \"required\";\n          fields[validationKey] = {\n            forAttribute: currentFor,\n            inputId,\n            inputField: input\n          };\n        }\n      }\n    });\n\n    const validator = new validatorjs(data, rules);\n\n    if (!validator.passes()) {\n      const errors = validator.errors.all();\n      let currentForm = null;\n\n      Object.keys(errors).forEach(error => {\n        const parentNode = fields[error].inputField.parentNode;\n        const inputNode = fields[error].inputField;\n        let hasAddedParentClass = false;\n\n        currentForm = inputNode.form;\n\n        if (\n          !parentNode.className.includes(\"field-validation-error-message\") &&\n          parentNode.tagName === \"DIV\"\n        ) {\n          hasAddedParentClass = true;\n          parentNode.setAttribute(\"data-error-message\", errors[error]);\n          parentNode.className += \" field-validation-error-message\";\n        }\n\n        if (\n          !inputNode.className.includes(\"field-validation-error\") &&\n          inputNode.tagName === \"INPUT\"\n        ) {\n          inputNode.addEventListener(\"change\", () =>\n            this.resetErrorStyles({\n              inputNode,\n              parentNode,\n              hasAddedParentClass\n            })\n          );\n          inputNode.className += \" field-validation-error\";\n        }\n      });\n\n      event.stopPropagation();\n      event.preventDefault();\n\n      // Scroll up the form so users can see validation errors\n      currentForm &&\n        currentForm &&\n        currentForm.scrollIntoView &&\n        currentForm.scrollIntoView({\n          behavior: \"smooth\",\n          block: \"start\",\n          inline: \"nearest\"\n        });\n\n      return;\n    }\n  }\n\n  /**\n   * Creates the actual upload instance to be used when a user uploads\n   * some files.\n   */\n  buildUploader() {\n    const { fileInput } = this;\n    const error = new Error();\n    // NOTE: We only want to run the build over fields that have not been modified yet\n    const validFileInput = !fileInput.className.includes(\"sqsf-uploader\");\n\n    if (!validFileInput) {\n      error.message = \"Invalid File Input Field\";\n      // console.error(error);\n      return;\n    }\n\n    let textInput = fileInput.querySelector(\".field-element\");\n\n    if (!textInput) {\n      error.message = \"Invalid Text Input Field\";\n      // console.error(error);\n      return;\n    }\n\n    // Get placeholder\n    const placeholderElement = textInput.getAttribute(\"placeholder\");\n    const allowedExtensions = (placeholderElement &&\n      placeholderElement.replace(/\\s/g, \"\").split(\",\")) || [\n      \".jpg\",\n      \".jpeg\",\n      \".png\",\n      \".gif\",\n      \".txt\"\n    ];\n\n    // Get description\n    const descriptionElement = fileInput.querySelector(\".description\");\n    const descriptionValue =\n      descriptionElement && descriptionElement.textContent.replace(/\\s/g, \"\");\n\n    const fileInputId = fileInput.getAttribute(\"id\");\n\n    if (fileInput.querySelector(\".description\")) {\n      fileInput.querySelector(\".description\").style.display = \"none\";\n    }\n\n    if (textInput) {\n      textInput.style.display = \"none\";\n    }\n\n    if (textInput && textInput.tagName !== \"TEXTAREA\") {\n      textInput.style.display = \"none\";\n\n      const replacementInput = document.createElement(\"textarea\");\n      replacementInput.id = textInput.id;\n      replacementInput.style.display = \"none\";\n      replacementInput.className = textInput.className;\n      replacementInput.value = textInput.value.replace(/   /g, \"   \\n\");\n      fileInput.removeChild(textInput);\n      fileInput.appendChild(replacementInput);\n    }\n\n    const uploadProgressUrl = null;\n\n    const defaultConfigOptions = {\n      Multiple: false,\n      MaxSize: 10480,\n      ButtonLabel: \"Add_Your_Files\",\n      RequiredField: \"Label_Name\",\n      RequiredFieldMessage:\n        \"Enter_the_name_of_your_Label_before_uploading_your_Collection.\"\n    };\n\n    const configOptions = descriptionValue\n      .replace(/\\s/g, \"\")\n      .split(\";\")\n      .reduce((result, currentOption) => {\n        const keyValuePair = currentOption.split(\"=\");\n\n        return {\n          ...result,\n          [keyValuePair[0]]:\n            (keyValuePair[1] && keyValuePair[1].replace(/_/g, \" \")) || true\n        };\n      }, defaultConfigOptions);\n\n    const {\n      ButtonLabel: buttonLabel,\n      Multiple: isMultiple,\n      MaxSize: maxSize,\n      RequiredField: requiredField,\n      RequiredFieldMessage: requiredMessage\n    } = configOptions;\n\n    this.requirements = {\n      field: requiredField.replace(/_/g, \" \"),\n      message: requiredMessage.replace(/_/g, \" \")\n    };\n\n    const fileInputNode = fileInput.querySelector(\".fileInput\");\n    if (fileInputNode) {\n      while (fileInputNode.firstChild) {\n        fileInputNode.removeChild(fileInputNode.firstChild);\n      }\n      fileInput.removeChild(fileInputNode);\n    }\n\n    const inside = document.createElement(\"div\");\n    inside.innerHTML = `<div style=\"margin-right: 15px;\" class=\"uploadButton button sqs-system-button sqs-editable-button\">\n            ${buttonLabel}\n            </div>\n            <div class=\"progressBox\"></div>\n            <div class=\"messageBox\"></div>`;\n    inside.className = \"fileInput field-element clear\";\n    fileInput.appendChild(inside);\n\n    // TODO: Move error to above innerHTML\n    const errorBox = document.createElement(\"div\");\n    errorBox.className = \"field-error\";\n\n    const messageBox = fileInput.querySelectorAll(\".messageBox\")[0];\n\n    /**\n     * Creates a dynamic folder property so that when the upload\n     * is triggered it fetches what the user has entered into the\n     * label field.\n     */\n    const extraFormData = new Proxy(\n      {\n        folder: null\n      },\n      {\n        get: (value, key) => {\n          if (key === \"folder\") {\n            // TODO: Get the form name or the button label and use that as a default\n            return `${this.folderBaseName}/${this.folderName || \"default\"}`;\n          }\n          return Reflect.get(value, key);\n        }\n      }\n    );\n\n    fileInput.className = fileInput.className + \" sqsf-uploader\";\n\n    if (textInput.value) {\n      var urls_added = textInput.value.split(\"   \\n\").length;\n      var z = urls_added > 1 ? \"s\" : \"\";\n      var success = document.createElement(\"div\");\n      success.className = \"upload-success\";\n      success.innerHTML =\n        '<div class=\"name\" style=\"margin:10px 10px 10px 0;color: green;\">' +\n        urls_added +\n        \" <span>file\" +\n        z +\n        \" already added.</span></div>\";\n      messageBox.appendChild(success);\n    }\n\n    /**\n     * Create the file uploader.\n     */\n    const uploader = new SAU.SimpleUpload({\n      customHeaders: {\n        \"User-Id\": USER_ID\n      },\n      id: fileInputId,\n      accept: allowedExtensions.toString(),\n      multipart: true,\n      multiple: isMultiple,\n      multipleSelect: isMultiple,\n      button: fileInput.querySelector(\".uploadButton\"),\n      dropzone: fileInput.querySelector(\".uploadButton\"),\n      url: UPLOAD_URL,\n      name: \"file\",\n      data: extraFormData,\n      sessionProgressUrl: uploadProgressUrl,\n      responseType: \"json\",\n      allowedExtensions: allowedExtensions.map(allowedExtension => {\n        return allowedExtension.replace(/\\./g, \"\").replace(/\\s/g, \"\");\n      }),\n      maxSize: +maxSize, // kilobytes\n      hoverClass: \"ui-state-hover\",\n      focusClass: \"ui-state-focus\",\n      disabledClass: \"ui-state-disabled\",\n      onChange: () => {\n        fileInput.querySelector(\".field-error\") &&\n          fileInput.removeChild(fileInput.querySelector(\".field-error\"));\n      },\n      onExtError: (fileName, ext) => {\n        const errorMessage = `Your file ${fileName} is ${ext} type. We accept only these files ${allowedExtensions}`;\n\n        errorBox.innerHTML = errorMessage;\n        fileInput.insertBefore(errorBox, fileInput.querySelector(\".title\"));\n      },\n      onSizeError: (fileName, fileSize) => {\n        const errorMessage = `Your file ${fileName} is to large! You need to compress the image or resize it, so it's smaller.`;\n        fileInput.insertBefore(errorBox, fileInput.querySelector(\".title\"));\n      },\n      onBlankSubmit: function(event) {\n        console.warn(\"EMPTY SUBMIT: \", event);\n      },\n      onSubmit: function(fileName, extension, i, fileSize) {\n        fileInput.querySelector(\".field-error\") &&\n          fileInput.removeChild(fileInput.querySelector(\".field-error\"));\n\n        let progress = document.createElement(\"div\");\n        progress.className = \"progress\";\n        progress.style = \"width:100%; height: 4px; margin: 5px 0;\";\n\n        let bar = document.createElement(\"div\");\n        bar.className = \"progress-bar\";\n        bar.style =\n          \"background: #a5a5a5; height: 100%; transition: width 1s 0.1s ease;\";\n        progress.appendChild(bar);\n\n        let wrapper = document.createElement(\"div\");\n        wrapper.className = \"wrapper\";\n        wrapper.innerHTML =\n          '<div class=\"name\" style=\"margin:10px 10px 10px 0\">' +\n          fileName +\n          \" <span> - \" +\n          fileSize +\n          \"KB</span></div>\";\n        wrapper.appendChild(progress);\n\n        let progressBox = fileInput.querySelector(\".progressBox\");\n        progressBox.appendChild(wrapper);\n\n        if (!isMultiple) {\n          const wrappers = Array.prototype.slice.call(\n            fileInput.querySelectorAll(\".wrapper\")\n          );\n          wrappers.forEach(function(wrap) {\n            wrap.parentNode.removeChild(wrap);\n          });\n        }\n\n        this && this.setProgressBar && this.setProgressBar(bar);\n        this && this.setProgressContainer && this.setProgressContainer(wrapper);\n      },\n      onComplete: function(fileName, response) {\n        if (!response) {\n          errorBox.textContent = `${fileName} upload failed`;\n          fileInput.insertBefore(errorBox, fileInput.querySelector(\".title\"));\n          return;\n        } else {\n          if (response.success && response.urls.length) {\n            const allUrls = response.urls.reduce((result, currentUrl) => {\n              return `${result}\\n${currentUrl}`;\n            }, \"\");\n\n            textInput.value = `${textInput.value}${allUrls}`;\n\n            var success = document.createElement(\"div\");\n            success.className = \"upload-success\";\n            success.innerHTML = `<div class=\"name\" style=\"margin:10px 10px 10px 0;color: green;\">${fileName}</div>`;\n            messageBox.appendChild(success);\n          }\n        }\n      }\n    });\n\n    const uploadInput = document.querySelector(\"input[type=file][name=file]\");\n    uploadInput.addEventListener(\"click\", this.handleValidation);\n\n    console.warn(\"UPLOADER: \", uploader);\n\n    return uploader;\n  }\n}\n\nexport default FormUploader;\n"]}